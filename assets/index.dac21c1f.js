var yt=Object.defineProperty,_t=Object.defineProperties;var wt=Object.getOwnPropertyDescriptors;var pt=Object.getOwnPropertySymbols;var bt=Object.prototype.hasOwnProperty,xt=Object.prototype.propertyIsEnumerable;var ht=(e,t,r)=>t in e?yt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,je=(e,t)=>{for(var r in t||(t={}))bt.call(t,r)&&ht(e,r,t[r]);if(pt)for(var r of pt(t))xt.call(t,r)&&ht(e,r,t[r]);return e},gt=(e,t)=>_t(e,wt(t));const p=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const o of a)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const o={};return a.integrity&&(o.integrity=a.integrity),a.referrerpolicy&&(o.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?o.credentials="include":a.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function n(a){if(a.ep)return;a.ep=!0;const o=r(a);fetch(a.href,o)}};p();function noop$4(){}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return typeof e=="function"}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&typeof e=="object"||typeof e=="function"}function is_empty(e){return Object.keys(e).length===0}function append(e,t){e.appendChild(t)}function insert(e,t,r){e.insertBefore(t,r||null)}function detach(e){e.parentNode.removeChild(e)}function destroy_each(e,t){for(let r=0;r<e.length;r+=1)e[r]&&e[r].d(t)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,t,r,n){return e.addEventListener(t,r,n),()=>e.removeEventListener(t,r,n)}function attr(e,t,r){r==null?e.removeAttribute(t):e.getAttribute(t)!==r&&e.setAttribute(t,r)}function children(e){return Array.from(e.childNodes)}function set_data(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function set_input_value(e,t){e.value=t==null?"":t}function select_option(e,t){for(let r=0;r<e.options.length;r+=1){const n=e.options[r];if(n.__value===t){n.selected=!0;return}}e.selectedIndex=-1}function select_value(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function toggle_class(e,t,r){e.classList[r?"add":"remove"](t)}function custom_event(e,t,{bubbles:r=!1,cancelable:n=!1}={}){const a=document.createEvent("CustomEvent");return a.initCustomEvent(e,r,n,t),a}let current_component;function set_current_component(e){current_component=e}function get_current_component(){if(!current_component)throw new Error("Function called outside component initialization");return current_component}function createEventDispatcher(){const e=get_current_component();return(t,r,{cancelable:n=!1}={})=>{const a=e.$$.callbacks[t];if(a){const o=custom_event(t,r,{cancelable:n});return a.slice().forEach(i=>{i.call(e,o)}),!o.defaultPrevented}return!0}}const dirty_components=[],binding_callbacks=[],render_callbacks=[],flush_callbacks=[],resolved_promise=Promise.resolve();let update_scheduled=!1;function schedule_update(){update_scheduled||(update_scheduled=!0,resolved_promise.then(flush))}function add_render_callback(e){render_callbacks.push(e)}const seen_callbacks=new Set;let flushidx=0;function flush(){const e=current_component;do{for(;flushidx<dirty_components.length;){const t=dirty_components[flushidx];flushidx++,set_current_component(t),update(t.$$)}for(set_current_component(null),dirty_components.length=0,flushidx=0;binding_callbacks.length;)binding_callbacks.pop()();for(let t=0;t<render_callbacks.length;t+=1){const r=render_callbacks[t];seen_callbacks.has(r)||(seen_callbacks.add(r),r())}render_callbacks.length=0}while(dirty_components.length);for(;flush_callbacks.length;)flush_callbacks.pop()();update_scheduled=!1,seen_callbacks.clear(),set_current_component(e)}function update(e){if(e.fragment!==null){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}const outroing=new Set;let outros;function group_outros(){outros={r:0,c:[],p:outros}}function check_outros(){outros.r||run_all(outros.c),outros=outros.p}function transition_in(e,t){e&&e.i&&(outroing.delete(e),e.i(t))}function transition_out(e,t,r,n){if(e&&e.o){if(outroing.has(e))return;outroing.add(e),outros.c.push(()=>{outroing.delete(e),n&&(r&&e.d(1),n())}),e.o(t)}}function create_component(e){e&&e.c()}function mount_component(e,t,r,n){const{fragment:a,on_mount:o,on_destroy:i,after_update:u}=e.$$;a&&a.m(t,r),n||add_render_callback(()=>{const f=o.map(run).filter(is_function);i?i.push(...f):run_all(f),e.$$.on_mount=[]}),u.forEach(add_render_callback)}function destroy_component(e,t){const r=e.$$;r.fragment!==null&&(run_all(r.on_destroy),r.fragment&&r.fragment.d(t),r.on_destroy=r.fragment=null,r.ctx=[])}function make_dirty(e,t){e.$$.dirty[0]===-1&&(dirty_components.push(e),schedule_update(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,r,n,a,o,i,u=[-1]){const f=current_component;set_current_component(e);const c=e.$$={fragment:null,ctx:null,props:o,update:noop$4,not_equal:a,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(f?f.$$.context:[])),callbacks:blank_object(),dirty:u,skip_bound:!1,root:t.target||f.$$.root};i&&i(c.root);let l=!1;if(c.ctx=r?r(e,t.props||{},(s,d,...h)=>{const v=h.length?h[0]:d;return c.ctx&&a(c.ctx[s],c.ctx[s]=v)&&(!c.skip_bound&&c.bound[s]&&c.bound[s](v),l&&make_dirty(e,s)),d}):[],c.update(),l=!0,run_all(c.before_update),c.fragment=n?n(c.ctx):!1,t.target){if(t.hydrate){const s=children(t.target);c.fragment&&c.fragment.l(s),s.forEach(detach)}else c.fragment&&c.fragment.c();t.intro&&transition_in(e.$$.fragment),mount_component(e,t.target,t.anchor,t.customElement),flush()}set_current_component(f)}class SvelteComponent{$destroy(){destroy_component(this,1),this.$destroy=noop$4}$on(t,r){const n=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return n.push(r),()=>{const a=n.indexOf(r);a!==-1&&n.splice(a,1)}}$set(t){this.$$set&&!is_empty(t)&&(this.$$.skip_bound=!0,this.$$set(t),this.$$.skip_bound=!1)}}var commonjsGlobal=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},ngraph_events$2=function(t){validateSubject$2(t);var r=createEventsStorage$2(t);return t.on=r.on,t.off=r.off,t.fire=r.fire,t};function createEventsStorage$2(e){var t=Object.create(null);return{on:function(r,n,a){if(typeof n!="function")throw new Error("callback is expected to be a function");var o=t[r];return o||(o=t[r]=[]),o.push({callback:n,ctx:a}),e},off:function(r,n){var a=typeof r=="undefined";if(a)return t=Object.create(null),e;if(t[r]){var o=typeof n!="function";if(o)delete t[r];else for(var i=t[r],u=0;u<i.length;++u)i[u].callback===n&&i.splice(u,1)}return e},fire:function(r){var n=t[r];if(!n)return e;var a;arguments.length>1&&(a=Array.prototype.splice.call(arguments,1));for(var o=0;o<n.length;++o){var i=n[o];i.callback.apply(i.ctx,a)}return e}}}function validateSubject$2(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],r=0;r<t.length;++r)if(e.hasOwnProperty(t[r]))throw new Error("Subject cannot be eventified, since it already has property '"+t[r]+"'")}console.log("[import] bus:",ngraph_events$2);var bus=ngraph_events$2({}),wheel$1={exports:{}};wheel$1.exports=addWheelListener;wheel$1.exports.addWheelListener=addWheelListener;wheel$1.exports.removeWheelListener=removeWheelListener;function addWheelListener(e,t,r){e.addEventListener("wheel",t,r)}function removeWheelListener(e,t,r){e.removeEventListener("wheel",t,r)}var amator={exports:{}},NEWTON_ITERATIONS=4,NEWTON_MIN_SLOPE=.001,SUBDIVISION_PRECISION=1e-7,SUBDIVISION_MAX_ITERATIONS=10,kSplineTableSize=11,kSampleStepSize=1/(kSplineTableSize-1),float32ArraySupported=typeof Float32Array=="function";function A(e,t){return 1-3*t+3*e}function B(e,t){return 3*t-6*e}function C(e){return 3*e}function calcBezier(e,t,r){return((A(t,r)*e+B(t,r))*e+C(t))*e}function getSlope(e,t,r){return 3*A(t,r)*e*e+2*B(t,r)*e+C(t)}function binarySubdivide(e,t,r,n,a){var o,i,u=0;do i=t+(r-t)/2,o=calcBezier(i,n,a)-e,o>0?r=i:t=i;while(Math.abs(o)>SUBDIVISION_PRECISION&&++u<SUBDIVISION_MAX_ITERATIONS);return i}function newtonRaphsonIterate(e,t,r,n){for(var a=0;a<NEWTON_ITERATIONS;++a){var o=getSlope(t,r,n);if(o===0)return t;var i=calcBezier(t,r,n)-e;t-=i/o}return t}function LinearEasing(e){return e}var src=function(t,r,n,a){if(!(0<=t&&t<=1&&0<=n&&n<=1))throw new Error("bezier x values must be in [0, 1] range");if(t===r&&n===a)return LinearEasing;for(var o=float32ArraySupported?new Float32Array(kSplineTableSize):new Array(kSplineTableSize),i=0;i<kSplineTableSize;++i)o[i]=calcBezier(i*kSampleStepSize,t,n);function u(f){for(var c=0,l=1,s=kSplineTableSize-1;l!==s&&o[l]<=f;++l)c+=kSampleStepSize;--l;var d=(f-o[l])/(o[l+1]-o[l]),h=c+d*kSampleStepSize,v=getSlope(h,t,n);return v>=NEWTON_MIN_SLOPE?newtonRaphsonIterate(f,h,t,n):v===0?h:binarySubdivide(f,c,c+kSampleStepSize,t,n)}return function(c){return c===0?0:c===1?1:calcBezier(u(c),r,a)}},BezierEasing=src,animations={ease:BezierEasing(.25,.1,.25,1),easeIn:BezierEasing(.42,0,1,1),easeOut:BezierEasing(0,0,.58,1),easeInOut:BezierEasing(.42,0,.58,1),linear:BezierEasing(0,0,1,1)};amator.exports=animate$1;amator.exports.makeAggregateRaf=makeAggregateRaf;amator.exports.sharedScheduler=makeAggregateRaf();function animate$1(e,t,r){var n=Object.create(null),a=Object.create(null);r=r||{};var o=typeof r.easing=="function"?r.easing:animations[r.easing];o||(r.easing&&console.warn("Unknown easing function in amator: "+r.easing),o=animations.ease);var i=typeof r.step=="function"?r.step:noop$3,u=typeof r.done=="function"?r.done:noop$3,f=getScheduler(r.scheduler),c=Object.keys(t);c.forEach(function(E){n[E]=e[E],a[E]=t[E]-e[E]});var l=typeof r.duration=="number"?r.duration:400,s=Math.max(1,l*.06),d,h=0;return d=f.next(g),{cancel:v};function v(){f.cancel(d),d=0}function g(){var E=o(h/s);h+=1,m(E),h<=s?(d=f.next(g),i(e)):(d=0,setTimeout(function(){u(e)},0))}function m(E){c.forEach(function(S){e[S]=a[S]*E+n[S]})}}function noop$3(){}function getScheduler(e){if(!e){var t=typeof window!="undefined"&&window.requestAnimationFrame;return t?rafScheduler():timeoutScheduler()}if(typeof e.next!="function")throw new Error("Scheduler is supposed to have next(cb) function");if(typeof e.cancel!="function")throw new Error("Scheduler is supposed to have cancel(handle) function");return e}function rafScheduler(){return{next:window.requestAnimationFrame.bind(window),cancel:window.cancelAnimationFrame.bind(window)}}function timeoutScheduler(){return{next:function(e){return setTimeout(e,1e3/60)},cancel:function(e){return clearTimeout(e)}}}function makeAggregateRaf(){var e=new Set,t=new Set,r=0;return{next:a,cancel:a,clearAll:n};function n(){e.clear(),t.clear(),cancelAnimationFrame(r),r=0}function a(u){t.add(u),o()}function o(){r||(r=requestAnimationFrame(i))}function i(){r=0;var u=t;t=e,e=u,e.forEach(function(f){f()}),e.clear()}}var ngraph_events$1=function(t){validateSubject$1(t);var r=createEventsStorage$1(t);return t.on=r.on,t.off=r.off,t.fire=r.fire,t};function createEventsStorage$1(e){var t=Object.create(null);return{on:function(r,n,a){if(typeof n!="function")throw new Error("callback is expected to be a function");var o=t[r];return o||(o=t[r]=[]),o.push({callback:n,ctx:a}),e},off:function(r,n){var a=typeof r=="undefined";if(a)return t=Object.create(null),e;if(t[r]){var o=typeof n!="function";if(o)delete t[r];else for(var i=t[r],u=0;u<i.length;++u)i[u].callback===n&&i.splice(u,1)}return e},fire:function(r){var n=t[r];if(!n)return e;var a;arguments.length>1&&(a=Array.prototype.splice.call(arguments,1));for(var o=0;o<n.length;++o){var i=n[o];i.callback.apply(i.ctx,a)}return e}}}function validateSubject$1(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],r=0;r<t.length;++r)if(e.hasOwnProperty(t[r]))throw new Error("Subject cannot be eventified, since it already has property '"+t[r]+"'")}var kinetic_1=kinetic$1;function kinetic$1(e,t,r){typeof r!="object"&&(r={});var n=typeof r.minVelocity=="number"?r.minVelocity:5,a=typeof r.amplitude=="number"?r.amplitude:.25,o=typeof r.cancelAnimationFrame=="function"?r.cancelAnimationFrame:getCancelAnimationFrame(),i=typeof r.requestAnimationFrame=="function"?r.requestAnimationFrame:getRequestAnimationFrame(),u,f,c=342,l,s,d,h,v,g,m,E;return{start:_,stop:y,cancel:S};function S(){o(l),o(E)}function _(){u=e(),h=m=s=v=0,f=new Date,o(l),o(E),l=i(x)}function x(){var V=Date.now(),q=V-f;f=V;var L=e(),T=L.x-u.x,N=L.y-u.y;u=L;var G=1e3/(1+q);s=.8*T*G+.2*s,v=.8*N*G+.2*v,l=i(x)}function y(){o(l),o(E);var V=e();d=V.x,g=V.y,f=Date.now(),(s<-n||s>n)&&(h=a*s,d+=h),(v<-n||v>n)&&(m=a*v,g+=m),E=i(k)}function k(){var V=Date.now()-f,q=!1,L=0,T=0;h&&(L=-h*Math.exp(-V/c),L>.5||L<-.5?q=!0:L=h=0),m&&(T=-m*Math.exp(-V/c),T>.5||T<-.5?q=!0:T=m=0),q&&(t(d+L,g+T),E=i(k))}}function getCancelAnimationFrame(){return typeof cancelAnimationFrame=="function"?cancelAnimationFrame:clearTimeout}function getRequestAnimationFrame(){return typeof requestAnimationFrame=="function"?requestAnimationFrame:function(e){return setTimeout(e,16)}}var createTextSelectionInterceptor_1=createTextSelectionInterceptor$1;function createTextSelectionInterceptor$1(e){if(e)return{capture:noop$2,release:noop$2};var t,r,n,a=!1;return{capture:o,release:i};function o(u){a=!0,r=window.document.onselectstart,n=window.document.ondragstart,window.document.onselectstart=disabled,t=u,t.ondragstart=disabled}function i(){!a||(a=!1,window.document.onselectstart=r,t&&(t.ondragstart=n))}}function disabled(e){return e.stopPropagation(),!1}function noop$2(){}var transform=Transform$1;function Transform$1(){this.x=0,this.y=0,this.scale=1}var svgController={exports:{}};svgController.exports=makeSvgController$1;svgController.exports.canAttach=isSVGElement;function makeSvgController$1(e,t){if(!isSVGElement(e))throw new Error("svg element is required for svg.panzoom to work");var r=e.ownerSVGElement;if(!r)throw new Error("Do not apply panzoom to the root <svg> element. Use its child instead (e.g. <g></g>). As of March 2016 only FireFox supported transform on the root element");t.disableKeyboardInteraction||r.setAttribute("tabindex",0);var n={getBBox:o,getScreenCTM:i,getOwner:a,applyTransform:f,initTransform:u};return n;function a(){return r}function o(){var c=e.getBBox();return{left:c.x,top:c.y,width:c.width,height:c.height}}function i(){var c=r.getCTM();return c||r.getScreenCTM()}function u(c){var l=e.getCTM();l===null&&(l=document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGMatrix()),c.x=l.e,c.y=l.f,c.scale=l.a,r.removeAttributeNS(null,"viewBox")}function f(c){e.setAttribute("transform","matrix("+c.scale+" 0 0 "+c.scale+" "+c.x+" "+c.y+")")}}function isSVGElement(e){return e&&e.ownerSVGElement&&e.getCTM}var domController={exports:{}};domController.exports=makeDomController$1;domController.exports.canAttach=isDomElement;function makeDomController$1(e,t){var r=isDomElement(e);if(!r)throw new Error("panzoom requires DOM element to be attached to the DOM tree");var n=e.parentElement;e.scrollTop=0,t.disableKeyboardInteraction||n.setAttribute("tabindex",0);var a={getBBox:i,getOwner:o,applyTransform:u};return a;function o(){return n}function i(){return{left:0,top:0,width:e.clientWidth,height:e.clientHeight}}function u(f){e.style.transformOrigin="0 0 0",e.style.transform="matrix("+f.scale+", 0, 0, "+f.scale+", "+f.x+", "+f.y+")"}}function isDomElement(e){return e&&e.parentElement&&e.style}var wheel=wheel$1.exports,animate=amator.exports,eventify$3=ngraph_events$1,kinetic=kinetic_1,createTextSelectionInterceptor=createTextSelectionInterceptor_1,domTextSelectionInterceptor=createTextSelectionInterceptor(),fakeTextSelectorInterceptor=createTextSelectionInterceptor(!0),Transform=transform,makeSvgController=svgController.exports,makeDomController=domController.exports,defaultZoomSpeed=1,defaultDoubleTapZoomSpeed=1.75,doubleTapSpeedInMS=300,clickEventTimeInMS=200,panzoom=createPanZoom;function createPanZoom(e,t){t=t||{};var r=t.controller;if(r||(makeSvgController.canAttach(e)?r=makeSvgController(e,t):makeDomController.canAttach(e)&&(r=makeDomController(e,t))),!r)throw new Error("Cannot create panzoom for the current type of dom element");var n=r.getOwner(),a={x:0,y:0},o=!1,i=new Transform;r.initTransform&&r.initTransform(i);var u=typeof t.filterKey=="function"?t.filterKey:noop$1,f=typeof t.pinchSpeed=="number"?t.pinchSpeed:1,c=t.bounds,l=typeof t.maxZoom=="number"?t.maxZoom:Number.POSITIVE_INFINITY,s=typeof t.minZoom=="number"?t.minZoom:0,d=typeof t.boundsPadding=="number"?t.boundsPadding:.05,h=typeof t.zoomDoubleClickSpeed=="number"?t.zoomDoubleClickSpeed:defaultDoubleTapZoomSpeed,v=t.beforeWheel||noop$1,g=t.beforeMouseDown||noop$1,m=typeof t.zoomSpeed=="number"?t.zoomSpeed:defaultZoomSpeed,E=parseTransformOrigin(t.transformOrigin),S=t.enableTextSelection?fakeTextSelectorInterceptor:domTextSelectionInterceptor;validateBounds(c),t.autocenter&&se();var _,x=0,y=0,k=0,V=null,q=new Date,L,T=!1,N=!1,G,b,$,j,W,U;"smoothScroll"in t&&!t.smoothScroll?U=rigidScroll():U=kinetic(oe,Ie,t.smoothScroll);var Z,I,M,P=!1;Te();var F={dispose:Ne,moveBy:he,moveTo:le,smoothMoveTo:Ae,centerOn:Ce,zoomTo:Xe,zoomAbs:pe,smoothZoom:Ke,smoothZoomAbs:mt,showRectangle:Q,pause:te,resume:ne,isPaused:ae,getTransform:ue,getMinZoom:ce,setMinZoom:X,getMaxZoom:ge,setMaxZoom:we,getTransformOrigin:Pe,setTransformOrigin:be,getZoomSpeed:xe,setZoomSpeed:Ee};eventify$3(F);var H=typeof t.initialX=="number"?t.initialX:i.x,O=typeof t.initialY=="number"?t.initialY:i.y,K=typeof t.initialZoom=="number"?t.initialZoom:i.scale;return(H!=i.x||O!=i.y||K!=i.scale)&&pe(H,O,K),F;function te(){Le(),P=!0}function ne(){P&&(Te(),P=!1)}function ae(){return P}function Q(w){var D=n.getBoundingClientRect(),R=re(D.width,D.height),z=w.right-w.left,Y=w.bottom-w.top;if(!Number.isFinite(z)||!Number.isFinite(Y))throw new Error("Invalid rectangle");var J=R.x/z,ee=R.y/Y,ie=Math.min(J,ee);i.x=-(w.left+z/2)*ie+R.x/2,i.y=-(w.top+Y/2)*ie+R.y/2,i.scale=ie}function re(w,D){if(r.getScreenCTM){var R=r.getScreenCTM(),z=R.a,Y=R.d,J=R.e,ee=R.f;a.x=w*z-J,a.y=D*Y-ee}else a.x=w,a.y=D;return a}function se(){var w,D,R=0,z=0,Y=ye();if(Y)R=Y.left,z=Y.top,w=Y.right-Y.left,D=Y.bottom-Y.top;else{var J=n.getBoundingClientRect();w=J.width,D=J.height}var ee=r.getBBox();if(!(ee.width===0||ee.height===0)){var ie=D/ee.height,Ge=w/ee.width,Fe=Math.min(Ge,ie);i.x=-(ee.left+ee.width/2)*Fe+w/2+R,i.y=-(ee.top+ee.height/2)*Fe+D/2+z,i.scale=Fe}}function ue(){return i}function ce(){return s}function X(w){s=w}function ge(){return l}function we(w){l=w}function Pe(){return E}function be(w){E=parseTransformOrigin(w)}function xe(){return m}function Ee(w){if(!Number.isFinite(w))throw new Error("Zoom speed should be a number");m=w}function oe(){return{x:i.x,y:i.y}}function le(w,D){i.x=w,i.y=D,ve(),Ve("pan"),fe()}function me(w,D){le(i.x+w,i.y+D)}function ve(){var w=ye();if(!!w){var D=!1,R=ke(),z=w.left-R.right;return z>0&&(i.x+=z,D=!0),z=w.right-R.left,z<0&&(i.x+=z,D=!0),z=w.top-R.bottom,z>0&&(i.y+=z,D=!0),z=w.bottom-R.top,z<0&&(i.y+=z,D=!0),D}}function ye(){if(!!c){if(typeof c=="boolean"){var w=n.getBoundingClientRect(),D=w.width,R=w.height;return{left:D*d,top:R*d,right:D*(1-d),bottom:R*(1-d)}}return c}}function ke(){var w=r.getBBox(),D=_e(w.left,w.top);return{left:D.x,top:D.y,right:w.width*i.scale+D.x,bottom:w.height*i.scale+D.y}}function _e(w,D){return{x:w*i.scale+i.x,y:D*i.scale+i.y}}function fe(){o=!0,_=window.requestAnimationFrame(Ze)}function de(w,D,R){if(isNaN$1(w)||isNaN$1(D)||isNaN$1(R))throw new Error("zoom requires valid numbers");var z=i.scale*R;if(z<s){if(i.scale===s)return;R=s/i.scale}if(z>l){if(i.scale===l)return;R=l/i.scale}var Y=re(w,D);if(i.x=Y.x-R*(Y.x-i.x),i.y=Y.y-R*(Y.y-i.y),c&&d===1&&s===1)i.scale*=R,ve();else{var J=ve();J||(i.scale*=R)}Ve("zoom"),fe()}function pe(w,D,R){var z=R/i.scale;de(w,D,z)}function Ce(w){var D=w.ownerSVGElement;if(!D)throw new Error("ui element is required to be within the scene");var R=w.getBoundingClientRect(),z=R.left+R.width/2,Y=R.top+R.height/2,J=D.getBoundingClientRect(),ee=J.width/2-z,ie=J.height/2-Y;he(ee,ie,!0)}function Ae(w,D){he(w-i.x,D-i.y,!0)}function he(w,D,R){if(!R)return me(w,D);Z&&Z.cancel();var z={x:0,y:0},Y={x:w,y:D},J=0,ee=0;Z=animate(z,Y,{step:function(ie){me(ie.x-J,ie.y-ee),J=ie.x,ee=ie.y}})}function Ie(w,D){Qe(),le(w,D)}function Ne(){Le()}function Te(){n.addEventListener("mousedown",nt,{passive:!1}),n.addEventListener("dblclick",rt,{passive:!1}),n.addEventListener("touchstart",Ue,{passive:!1}),n.addEventListener("keydown",qe,{passive:!1}),wheel.addWheelListener(n,lt,{passive:!1}),fe()}function Le(){wheel.removeWheelListener(n,lt),n.removeEventListener("mousedown",nt),n.removeEventListener("keydown",qe),n.removeEventListener("dblclick",rt),n.removeEventListener("touchstart",Ue),_&&(window.cancelAnimationFrame(_),_=0),U.cancel(),it(),st(),S.release(),Je()}function Ze(){o&&De()}function De(){o=!1,r.applyTransform(i),Ve("transform"),_=0}function qe(w){var D=0,R=0,z=0;if(w.keyCode===38?R=1:w.keyCode===40?R=-1:w.keyCode===37?D=1:w.keyCode===39?D=-1:w.keyCode===189||w.keyCode===109?z=1:(w.keyCode===187||w.keyCode===107)&&(z=-1),!u(w,D,R,z)){if(D||R){w.preventDefault(),w.stopPropagation();var Y=n.getBoundingClientRect(),J=Math.min(Y.width,Y.height),ee=.05,ie=J*ee*D,Ge=J*ee*R;he(ie,Ge)}if(z){var Fe=ut(z*100),J=E?He():ze();Xe(J.x,J.y,Fe)}}}function ze(){var w=n.getBoundingClientRect();return{x:w.width/2,y:w.height/2}}function Ue(w){if(Re(w),$e(),w.touches.length===1)return Oe(w,w.touches[0]);w.touches.length===2&&(W=tt(w.touches[0],w.touches[1]),M=!0,We())}function Re(w){t.onTouch&&!t.onTouch(w)||(w.stopPropagation(),w.preventDefault())}function Be(w){$e(),!(t.onDoubleClick&&!t.onDoubleClick(w))&&(w.preventDefault(),w.stopPropagation())}function Oe(w){y=new Date;var D=w.touches[0],R=Me(D);L=R;var z=re(R.x,R.y);G=z.x,b=z.y,$=G,j=b,U.cancel(),We()}function We(){T||(T=!0,document.addEventListener("touchmove",Se),document.addEventListener("touchend",Ye),document.addEventListener("touchcancel",Ye))}function Se(w){if(w.touches.length===1){w.stopPropagation();var D=w.touches[0],R=Me(D),z=re(R.x,R.y),Y=z.x-G,J=z.y-b;Y!==0&&J!==0&&ct(),G=z.x,b=z.y,he(Y,J)}else if(w.touches.length===2){M=!0;var ee=w.touches[0],ie=w.touches[1],Ge=tt(ee,ie),Fe=1+(Ge/W-1)*f,ft=Me(ee),dt=Me(ie);if(G=(ft.x+dt.x)/2,b=(ft.y+dt.y)/2,E){var R=He();G=R.x,b=R.y}Xe(G,b,Fe),W=Ge,w.stopPropagation(),w.preventDefault()}}function $e(){k&&(clearTimeout(k),k=0)}function et(w){if(!!t.onClick){$e();var D=G-$,R=b-j,z=Math.sqrt(D*D+R*R);z>5||(k=setTimeout(function(){k=0,t.onClick(w)},doubleTapSpeedInMS))}}function Ye(w){if($e(),w.touches.length>0){var D=Me(w.touches[0]),R=re(D.x,D.y);G=R.x,b=R.y}else{var z=new Date;if(z-x<doubleTapSpeedInMS)if(E){var D=He();Ke(D.x,D.y,h)}else Ke(L.x,L.y,h);else z-y<clickEventTimeInMS&&et(w);x=z,Je(),st()}}function tt(w,D){var R=w.clientX-D.clientX,z=w.clientY-D.clientY;return Math.sqrt(R*R+z*z)}function rt(w){Be(w);var D=Me(w);E&&(D=He()),Ke(D.x,D.y,h)}function nt(w){if($e(),!g(w)){if(V=w,q=new Date,T)return w.stopPropagation(),!1;var D=w.button===1&&window.event!==null||w.button===0;if(!!D){U.cancel();var R=Me(w),z=re(R.x,R.y);return $=G=z.x,j=b=z.y,document.addEventListener("mousemove",at),document.addEventListener("mouseup",ot),S.capture(w.target||w.srcElement),!1}}}function at(w){if(!T){ct();var D=Me(w),R=re(D.x,D.y),z=R.x-G,Y=R.y-b;G=R.x,b=R.y,he(z,Y)}}function ot(){var w=new Date;w-q<clickEventTimeInMS&&et(V),S.release(),Je(),it()}function it(){document.removeEventListener("mousemove",at),document.removeEventListener("mouseup",ot),N=!1}function st(){document.removeEventListener("touchmove",Se),document.removeEventListener("touchend",Ye),document.removeEventListener("touchcancel",Ye),N=!1,M=!1,T=!1}function lt(w){if(!v(w)){U.cancel();var D=w.deltaY;w.deltaMode>0&&(D*=100);var R=ut(D);if(R!==1){var z=E?He():Me(w);Xe(z.x,z.y,R),w.preventDefault()}}}function Me(w){var D,R,z=n.getBoundingClientRect();return D=w.clientX-z.left,R=w.clientY-z.top,{x:D,y:R}}function Ke(w,D,R){var z=i.scale,Y={scale:z},J={scale:R*z};U.cancel(),Qe(),I=animate(Y,J,{step:function(ee){pe(w,D,ee.scale)},done:vt})}function mt(w,D,R){var z=i.scale,Y={scale:z},J={scale:R};U.cancel(),Qe(),I=animate(Y,J,{step:function(ee){pe(w,D,ee.scale)}})}function He(){var w=n.getBoundingClientRect();return{x:w.width*E.x,y:w.height*E.y}}function Xe(w,D,R){return U.cancel(),Qe(),de(w,D,R)}function Qe(){I&&(I.cancel(),I=null)}function ut(w){var D=Math.sign(w),R=Math.min(.25,Math.abs(m*w/128));return 1-D*R}function ct(){N||(Ve("panstart"),N=!0,U.start())}function Je(){N&&(M||U.stop(),Ve("panend"))}function vt(){Ve("zoomend")}function Ve(w){F.fire(w,F)}}function parseTransformOrigin(e){if(!!e){if(typeof e=="object")return(!isNumber$1(e.x)||!isNumber$1(e.y))&&failTransformOrigin(e),e;failTransformOrigin()}}function failTransformOrigin(e){throw console.error(e),new Error(["Cannot parse transform origin.","Some good examples:",'  "center center" can be achieved with {x: 0.5, y: 0.5}','  "top center" can be achieved with {x: 0.5, y: 0}','  "bottom right" can be achieved with {x: 1, y: 1}'].join(`
`))}function noop$1(){}function validateBounds(e){var t=typeof e;if(!(t==="undefined"||t==="boolean")){var r=isNumber$1(e.left)&&isNumber$1(e.top)&&isNumber$1(e.bottom)&&isNumber$1(e.right);if(!r)throw new Error("Bounds object is not valid. It can be: undefined, boolean (true|false) or an object {left, top, right, bottom}")}}function isNumber$1(e){return Number.isFinite(e)}function isNaN$1(e){return Number.isNaN?Number.isNaN(e):e!==e}function rigidScroll(){return{start:noop$1,stop:noop$1,cancel:noop$1}}function autoRun(){if(typeof document=="undefined")return;var e=document.getElementsByTagName("script");if(!e)return;for(var t,r=0;r<e.length;++r){var n=e[r];if(n.src&&n.src.match(/\bpanzoom(\.min)?\.js/)){t=n;break}}if(!t)return;var a=t.getAttribute("query");if(!a)return;var o=t.getAttribute("name")||"pz",i=Date.now();u();function u(){var l=document.querySelector(a);if(!l){var s=Date.now(),d=s-i;if(d<2e3){setTimeout(u,100);return}console.error("Cannot find the panzoom element",o);return}var h=f(t);console.log(h),window[o]=createPanZoom(l,h)}function f(l){for(var s=l.attributes,d={},h=0;h<s.length;++h){var v=s[h],g=c(v);g&&(d[g.name]=g.value)}return d}function c(l){if(!!l.name){var s=l.name[0]==="p"&&l.name[1]==="z"&&l.name[2]==="-";if(!!s){var d=l.name.substr(3),h=JSON.parse(l.value);return{name:d,value:h}}}}}autoRun();var svgns$1="http://www.w3.org/2000/svg",xmlns="http://www.w3.org/XML/1998/namespace";function createTextMeasure(e,t){t=t||{},"useFastTextMeasure"in t||(t.useFastTextMeasure=!1);var r={},n=Object.create(null),a="abcdefghijklmnopqrstuvwxyz",o={},i={1:.4951923076923077,.875:.43509615384615385,.833:.41346153846153844,.75:.3701923076923077,.5:.24459134615384615};return u;function u(f,c){c<1&&(c=Math.round(c*1e3)/1e3);var l=f+c,s=r[l];if(s)return s;var d={};r[l]=d;var h=window.document.createElementNS(svgns$1,"text");return h.setAttributeNS(null,"font-size",c),h.setAttributeNS(xmlns,"xml:space","preserve"),e.appendChild(h),d.words=f.split(/\s/).map(m),d.spaceWidth=g(),d.totalWidth=v(d.words,d.spaceWidth),e.removeChild(h),d;function v(x,y){var k=0;return x.forEach(function(V){k+=V.width}),k+=(x.length-1)*y,k}function g(){var x="space"+c,y=o[x];return y||(h.textContent=" ",y=measureTextWidth(h),o[x]=y),y}function m(x){return{text:x,width:E(x)}}function E(x){return t.useFastTextMeasure?_(x):S(x)}function S(x){var y=x+c,k=n[y];if(k===void 0){if(h.textContent=x,k=measureTextWidth(h),k===0&&x.length>0){var V=i[c];if(V===void 0)throw new Error("Font size is not overriden for safari "+c);k=V*x.length}n[y]=k}return k}function _(x){var y=o[c];if(!y){h.textContent=a;var k=measureTextWidth(h);y=k/a.length,y===0&&(y=i[c]),o[c]=y}return y*x.length}}}function measureTextWidth(e){var t=e.getBBox();return t.width}class Vector{constructor(t,r){this.x=t,this.y=r}static sub(t,r){return new Vector(t.x-r.x,t.y-r.y)}static dist(t,r){let n=t.x-r.x,a=t.y-r.y;return Math.sqrt(n*n+a*a)}normalize(){let t=Math.sqrt(this.x*this.x+this.y*this.y);t===0&&(t=1e-4),this.x/=t,this.y/=t}mag(){return Math.sqrt(this.x*this.x+this.y*this.y)}add(t){this.x+=t.x,this.y+=t.y}sub(t){this.x-=t.x,this.y-=t.y}div(t){this.x/=t,this.y/=t}mult(t){this.x*=t,this.y*=t}limit(t){let r=this.mag();r>t&&(this.x*=t/r,this.y*=t/r)}distanceTo(t){let r=this.x-t.x,n=this.y-t.y;return Math.sqrt(r*r+n*n)}}var ngraph_random={exports:{}};ngraph_random.exports=random$2;ngraph_random.exports.random=random$2,ngraph_random.exports.randomIterator=randomIterator;function random$2(e){var t=typeof e=="number"?e:+new Date;return new Generator(t)}function Generator(e){this.seed=e}Generator.prototype.next=next;Generator.prototype.nextDouble=nextDouble;Generator.prototype.uniform=nextDouble;Generator.prototype.gaussian=gaussian;function gaussian(){var e,t,r;do t=this.nextDouble()*2-1,r=this.nextDouble()*2-1,e=t*t+r*r;while(e>=1||e===0);return t*Math.sqrt(-2*Math.log(e)/e)}Generator.prototype.levy=levy;function levy(){var e=1.5,t=Math.pow(gamma(1+e)*Math.sin(Math.PI*e/2)/(gamma((1+e)/2)*e*Math.pow(2,(e-1)/2)),1/e);return this.gaussian()*t/Math.pow(Math.abs(this.gaussian()),1/e)}function gamma(e){return Math.sqrt(2*Math.PI/e)*Math.pow(1/Math.E*(e+1/(12*e-1/(10*e))),e)}function nextDouble(){var e=this.seed;return e=e+2127912214+(e<<12)&4294967295,e=(e^3345072700^e>>>19)&4294967295,e=e+374761393+(e<<5)&4294967295,e=(e+3550635116^e<<9)&4294967295,e=e+4251993797+(e<<3)&4294967295,e=(e^3042594569^e>>>16)&4294967295,this.seed=e,(e&268435455)/268435456}function next(e){return Math.floor(this.nextDouble()*e)}function randomIterator(e,t){var r=t||random$2();if(typeof r.next!="function")throw new Error("customRandom does not match expected API: next() function is missing");return{forEach:a,shuffle:n};function n(){var o,i,u;for(o=e.length-1;o>0;--o)i=r.next(o+1),u=e[i],e[i]=e[o],e[o]=u;return e}function a(o){var i,u,f;for(i=e.length-1;i>0;--i)u=r.next(i+1),f=e[u],e[u]=e[i],e[i]=f,o(f);e.length&&o(e[0])}}var ngRandom=ngraph_random.exports,random$1=ngRandom(45);class Flock{constructor(t){this.graph=t,this.boids=new Map,this.neighbors=[]}run(){let t=this.boids;t.forEach((r,n)=>{let a=[];this.graph.forEachLinkedNode(n,function(o){let i=t.get(o.id);i&&a.push(i)}),r.run(a)})}addBoid(t,r){this.boids.set(t,r),this.neighbors.push(r)}setDesiredBoidPosition(t,r){const n=this.boids.get(t);!n||n.setDesiredPosition(r.x,r.y)}}class Boid{constructor(t,r){this.acceleration=new Vector(0,0);let n=random$1.nextDouble()*2*Math.PI;this.velocity=new Vector(Math.cos(n),Math.sin(n)),this.position=new Vector(t,r),this.desiredPosition=new Vector(0,0),this.r=400,this.maxspeed=3,this.maxforce=.08}run(t){this.flock(t),this.update()}applyForce(t,r){t.div(r),this.acceleration.add(t)}setDesiredPosition(t,r){this.desiredPosition.x=t,this.desiredPosition.y=r}flock(t){let r=this.separate(t),n=this.align(t),a=this.cohesion(t);const o=t.length||1;this.applyForce(r,o),this.applyForce(n,o),this.applyForce(a,o);const i=Vector.sub(this.desiredPosition,this.position);i.limit(.091),this.applyForce(i,o)}update(){this.velocity.add(this.acceleration),this.velocity.limit(this.maxspeed),this.position.add(this.velocity),this.acceleration.mult(0)}seek(t){const r=Vector.sub(t,this.position);r.normalize(),r.mult(this.maxspeed);let n=Vector.sub(r,this.velocity);return n.limit(this.maxforce*1),n}separate(t){const n=new Vector(0,0,0);let a=0;return t.forEach(o=>{let i=this.position.distanceTo(o.position);if(i>0&&i<40){let u=Vector.sub(this.position,o.position);u.normalize(),u.div(i),n.add(u),a++}}),a>0&&n.div(a),n.mag()>0&&(n.normalize(),n.mult(this.maxspeed),n.sub(this.velocity),n.limit(this.maxforce)),n}align(t){const n=new Vector(0,0);let a=0;if(t.forEach(o=>{let i=Vector.dist(this.position,o.position);i>0&&i<300&&(n.add(o.velocity),a++)}),a>0){n.div(a),n.normalize(),n.mult(this.maxspeed);let o=Vector.sub(n,this.velocity);return o.limit(this.maxforce),o}else return new Vector(0,0)}cohesion(t){let n=new Vector(0,0),a=0;return t.forEach(o=>{let i=Vector.dist(this.position,o.position);i>0&&i<300&&(n.add(o.position),a++)}),a>0?(n.div(a),this.seek(n)):new Vector(0,0)}}function createFakeLayout(e){let t=new Map,r=ngRandom(42);const n=new Flock(e);return{addNode:a,getNodePosition:o,setDesiredNodePosition:u,step:i};function a(f){const c={x:(r.nextDouble()-.5)*1e3,y:(r.nextDouble()-.5)*1e3},l=new Boid(c.x,c.y);return n.addBoid(f,l),t.set(f,l),l}function o(f){let c=t.get(f);return c||(c=a(f)),c.position}function i(){n.run()}function u(f,c){n.setDesiredBoidPosition(f,c)}}function createInterpolateLayout(e,t,r=100){let n=0,a=0;return{step:o,getNodePosition:u,done:i};function o(){a+=1}function i(){return a>r}function u(c){n=f(a/r);let l=e.getNodePosition(c),s=t.getNodePosition(c);return{x:l.x*(1-n)+s.x*n,y:l.y*(1-n)+s.y*n}}function f(c){return c*(2-c)}}var ngraph_disjointSet=DisjointSet$1;function DisjointSet$1(e){this.payload=e,this.parent=this,this.rank=0}DisjointSet$1.prototype.find=find;DisjointSet$1.prototype.union=union;function find(){var e=this.parent;return e!==this&&(this.parent=e.find()),this.parent}function union(e){var t=this.find(),r=e.find();r!==t&&(t.rank<r.rank?t.parent=r:t.rank>r.rank?r.parent=t:(r.parent=t,t.rank+=1))}var DisjointSet=ngraph_disjointSet,ngraph_kruskal=kruskal;function kruskal(e,t){var r=[];t=t||uniformWeight;var n=new Map,a=[];e.forEachNode(s),e.forEachLink(l),a.sort(d);for(var o=0;o<a.length;++o){var i=a[o].fromId,u=a[o].toId,f=n.get(i),c=n.get(u);f.find()!==c.find()&&(r.push(new TreeNode(i,u)),f.union(c))}return r;function l(h){a.push(h)}function s(h){n.set(h.id,new DisjointSet(h.id))}function d(h,v){return t(h)-t(v)}}function uniformWeight(e){return 1}function TreeNode(e,t){this.fromId=e,this.toId=t}const EPSILON=Math.pow(2,-52),EDGE_STACK=new Uint32Array(512);class Delaunator{static from(t,r=defaultGetX,n=defaultGetY){const a=t.length,o=new Float64Array(a*2);for(let i=0;i<a;i++){const u=t[i];o[2*i]=r(u),o[2*i+1]=n(u)}return new Delaunator(o)}constructor(t){const r=t.length>>1;if(r>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const n=Math.max(2*r-5,0);this._triangles=new Uint32Array(n*3),this._halfedges=new Int32Array(n*3),this._hashSize=Math.ceil(Math.sqrt(r)),this._hullPrev=new Uint32Array(r),this._hullNext=new Uint32Array(r),this._hullTri=new Uint32Array(r),this._hullHash=new Int32Array(this._hashSize).fill(-1),this._ids=new Uint32Array(r),this._dists=new Float64Array(r),this.update()}update(){const{coords:t,_hullPrev:r,_hullNext:n,_hullTri:a,_hullHash:o}=this,i=t.length>>1;let u=1/0,f=1/0,c=-1/0,l=-1/0;for(let T=0;T<i;T++){const N=t[2*T],G=t[2*T+1];N<u&&(u=N),G<f&&(f=G),N>c&&(c=N),G>l&&(l=G),this._ids[T]=T}const s=(u+c)/2,d=(f+l)/2;let h=1/0,v,g,m;for(let T=0;T<i;T++){const N=dist$1(s,d,t[2*T],t[2*T+1]);N<h&&(v=T,h=N)}const E=t[2*v],S=t[2*v+1];h=1/0;for(let T=0;T<i;T++){if(T===v)continue;const N=dist$1(E,S,t[2*T],t[2*T+1]);N<h&&N>0&&(g=T,h=N)}let _=t[2*g],x=t[2*g+1],y=1/0;for(let T=0;T<i;T++){if(T===v||T===g)continue;const N=circumradius(E,S,_,x,t[2*T],t[2*T+1]);N<y&&(m=T,y=N)}let k=t[2*m],V=t[2*m+1];if(y===1/0){for(let G=0;G<i;G++)this._dists[G]=t[2*G]-t[0]||t[2*G+1]-t[1];quicksort(this._ids,this._dists,0,i-1);const T=new Uint32Array(i);let N=0;for(let G=0,b=-1/0;G<i;G++){const $=this._ids[G];this._dists[$]>b&&(T[N++]=$,b=this._dists[$])}this.hull=T.subarray(0,N),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(orient(E,S,_,x,k,V)){const T=g,N=_,G=x;g=m,_=k,x=V,m=T,k=N,V=G}const q=circumcenter(E,S,_,x,k,V);this._cx=q.x,this._cy=q.y;for(let T=0;T<i;T++)this._dists[T]=dist$1(t[2*T],t[2*T+1],q.x,q.y);quicksort(this._ids,this._dists,0,i-1),this._hullStart=v;let L=3;n[v]=r[m]=g,n[g]=r[v]=m,n[m]=r[g]=v,a[v]=0,a[g]=1,a[m]=2,o.fill(-1),o[this._hashKey(E,S)]=v,o[this._hashKey(_,x)]=g,o[this._hashKey(k,V)]=m,this.trianglesLen=0,this._addTriangle(v,g,m,-1,-1,-1);for(let T=0,N,G;T<this._ids.length;T++){const b=this._ids[T],$=t[2*b],j=t[2*b+1];if(T>0&&Math.abs($-N)<=EPSILON&&Math.abs(j-G)<=EPSILON||(N=$,G=j,b===v||b===g||b===m))continue;let W=0;for(let P=0,F=this._hashKey($,j);P<this._hashSize&&(W=o[(F+P)%this._hashSize],!(W!==-1&&W!==n[W]));P++);W=r[W];let U=W,Z;for(;Z=n[U],!orient($,j,t[2*U],t[2*U+1],t[2*Z],t[2*Z+1]);)if(U=Z,U===W){U=-1;break}if(U===-1)continue;let I=this._addTriangle(U,b,n[U],-1,-1,a[U]);a[b]=this._legalize(I+2),a[U]=I,L++;let M=n[U];for(;Z=n[M],orient($,j,t[2*M],t[2*M+1],t[2*Z],t[2*Z+1]);)I=this._addTriangle(M,b,Z,a[b],-1,a[M]),a[b]=this._legalize(I+2),n[M]=M,L--,M=Z;if(U===W)for(;Z=r[U],orient($,j,t[2*Z],t[2*Z+1],t[2*U],t[2*U+1]);)I=this._addTriangle(Z,b,U,-1,a[U],a[Z]),this._legalize(I+2),a[Z]=I,n[U]=U,L--,U=Z;this._hullStart=r[b]=U,n[U]=r[M]=b,n[b]=M,o[this._hashKey($,j)]=b,o[this._hashKey(t[2*U],t[2*U+1])]=U}this.hull=new Uint32Array(L);for(let T=0,N=this._hullStart;T<L;T++)this.hull[T]=N,N=n[N];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,r){return Math.floor(pseudoAngle(t-this._cx,r-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:r,_halfedges:n,coords:a}=this;let o=0,i=0;for(;;){const u=n[t],f=t-t%3;if(i=f+(t+2)%3,u===-1){if(o===0)break;t=EDGE_STACK[--o];continue}const c=u-u%3,l=f+(t+1)%3,s=c+(u+2)%3,d=r[i],h=r[t],v=r[l],g=r[s];if(inCircle(a[2*d],a[2*d+1],a[2*h],a[2*h+1],a[2*v],a[2*v+1],a[2*g],a[2*g+1])){r[t]=g,r[u]=d;const E=n[s];if(E===-1){let _=this._hullStart;do{if(this._hullTri[_]===s){this._hullTri[_]=t;break}_=this._hullPrev[_]}while(_!==this._hullStart)}this._link(t,E),this._link(u,n[i]),this._link(i,s);const S=c+(u+1)%3;o<EDGE_STACK.length&&(EDGE_STACK[o++]=S)}else{if(o===0)break;t=EDGE_STACK[--o]}}return i}_link(t,r){this._halfedges[t]=r,r!==-1&&(this._halfedges[r]=t)}_addTriangle(t,r,n,a,o,i){const u=this.trianglesLen;return this._triangles[u]=t,this._triangles[u+1]=r,this._triangles[u+2]=n,this._link(u,a),this._link(u+1,o),this._link(u+2,i),this.trianglesLen+=3,u}}function pseudoAngle(e,t){const r=e/(Math.abs(e)+Math.abs(t));return(t>0?3-r:1+r)/4}function dist$1(e,t,r,n){const a=e-r,o=t-n;return a*a+o*o}function orientIfSure(e,t,r,n,a,o){const i=(n-t)*(a-e),u=(r-e)*(o-t);return Math.abs(i-u)>=33306690738754716e-32*Math.abs(i+u)?i-u:0}function orient(e,t,r,n,a,o){return(orientIfSure(a,o,e,t,r,n)||orientIfSure(e,t,r,n,a,o)||orientIfSure(r,n,a,o,e,t))<0}function inCircle(e,t,r,n,a,o,i,u){const f=e-i,c=t-u,l=r-i,s=n-u,d=a-i,h=o-u,v=f*f+c*c,g=l*l+s*s,m=d*d+h*h;return f*(s*m-g*h)-c*(l*m-g*d)+v*(l*h-s*d)<0}function circumradius(e,t,r,n,a,o){const i=r-e,u=n-t,f=a-e,c=o-t,l=i*i+u*u,s=f*f+c*c,d=.5/(i*c-u*f),h=(c*l-u*s)*d,v=(i*s-f*l)*d;return h*h+v*v}function circumcenter(e,t,r,n,a,o){const i=r-e,u=n-t,f=a-e,c=o-t,l=i*i+u*u,s=f*f+c*c,d=.5/(i*c-u*f),h=e+(c*l-u*s)*d,v=t+(i*s-f*l)*d;return{x:h,y:v}}function quicksort(e,t,r,n){if(n-r<=20)for(let a=r+1;a<=n;a++){const o=e[a],i=t[o];let u=a-1;for(;u>=r&&t[e[u]]>i;)e[u+1]=e[u--];e[u+1]=o}else{const a=r+n>>1;let o=r+1,i=n;swap(e,a,o),t[e[r]]>t[e[n]]&&swap(e,r,n),t[e[o]]>t[e[n]]&&swap(e,o,n),t[e[r]]>t[e[o]]&&swap(e,r,o);const u=e[o],f=t[u];for(;;){do o++;while(t[e[o]]<f);do i--;while(t[e[i]]>f);if(i<o)break;swap(e,o,i)}e[r+1]=e[i],e[i]=u,n-o+1>=i-r?(quicksort(e,t,o,n),quicksort(e,t,r,i-1)):(quicksort(e,t,r,i-1),quicksort(e,t,o,n))}}function swap(e,t,r){const n=e[t];e[t]=e[r],e[r]=n}function defaultGetX(e){return e[0]}function defaultGetY(e){return e[1]}var ngraph_graph=createGraph,eventify$2=ngraph_events$2;function createGraph(e){if(e=e||{},"uniqueLinkId"in e&&(console.warn("ngraph.graph: Starting from version 0.14 `uniqueLinkId` is deprecated.\nUse `multigraph` option instead\n",`
`,`Note: there is also change in default behavior: From now on each graph
is considered to be not a multigraph by default (each edge is unique).`),e.multigraph=e.uniqueLinkId),e.multigraph===void 0&&(e.multigraph=!1),typeof Map!="function")throw new Error("ngraph.graph requires `Map` to be defined. Please polyfill it before using ngraph");var t=new Map,r=[],n={},a=0,o=e.multigraph?x:_,i=[],u=j,f=j,c=j,l=j,s={addNode:g,addLink:S,removeLink:q,removeNode:E,getNode:m,getNodeCount:y,getLinkCount:k,getLinksCount:k,getNodesCount:y,getLinks:V,forEachNode:Z,forEachLinkedNode:G,forEachLink:N,beginUpdate:c,endUpdate:l,clear:T,hasLink:L,hasNode:m,getLink:L};return eventify$2(s),d(),s;function d(){var I=s.on;s.on=M;function M(){return s.beginUpdate=c=W,s.endUpdate=l=U,u=h,f=v,s.on=I,I.apply(s,arguments)}}function h(I,M){i.push({link:I,changeType:M})}function v(I,M){i.push({node:I,changeType:M})}function g(I,M){if(I===void 0)throw new Error("Invalid node identifier");c();var P=m(I);return P?(P.data=M,f(P,"update")):(P=new Node(I,M),f(P,"add")),t.set(I,P),l(),P}function m(I){return t.get(I)}function E(I){var M=m(I);if(!M)return!1;c();var P=M.links;if(P){M.links=null;for(var F=0;F<P.length;++F)q(P[F])}return t.delete(I),f(M,"remove"),l(),!0}function S(I,M,P){c();var F=m(I)||g(I),H=m(M)||g(M),O=o(I,M,P);return r.push(O),addLinkToNode(F,O),I!==M&&addLinkToNode(H,O),u(O,"add"),l(),O}function _(I,M,P){var F=makeLinkId(I,M);return new Link(I,M,P,F)}function x(I,M,P){var F=makeLinkId(I,M),H=n.hasOwnProperty(F);if(H||L(I,M)){H||(n[F]=0);var O="@"+ ++n[F];F=makeLinkId(I+O,M+O)}return new Link(I,M,P,F)}function y(){return t.size}function k(){return r.length}function V(I){var M=m(I);return M?M.links:null}function q(I){if(!I)return!1;var M=indexOfElementInArray(I,r);if(M<0)return!1;c(),r.splice(M,1);var P=m(I.fromId),F=m(I.toId);return P&&(M=indexOfElementInArray(I,P.links),M>=0&&P.links.splice(M,1)),F&&(M=indexOfElementInArray(I,F.links),M>=0&&F.links.splice(M,1)),u(I,"remove"),l(),!0}function L(I,M){var P=m(I),F;if(!P||!P.links)return null;for(F=0;F<P.links.length;++F){var H=P.links[F];if(H.fromId===I&&H.toId===M)return H}return null}function T(){c(),Z(function(I){E(I.id)}),l()}function N(I){var M,P;if(typeof I=="function")for(M=0,P=r.length;M<P;++M)I(r[M])}function G(I,M,P){var F=m(I);if(F&&F.links&&typeof M=="function")return P?$(F.links,I,M):b(F.links,I,M)}function b(I,M,P){for(var F,H=0;H<I.length;++H){var O=I[H],K=O.fromId===M?O.toId:O.fromId;if(F=P(t.get(K),O),F)return!0}}function $(I,M,P){for(var F,H=0;H<I.length;++H){var O=I[H];if(O.fromId===M&&(F=P(t.get(O.toId),O),F))return!0}}function j(){}function W(){a+=1}function U(){a-=1,a===0&&i.length>0&&(s.fire("changed",i),i.length=0)}function Z(I){if(typeof I!="function")throw new Error("Function is expected to iterate over graph nodes. You passed "+I);for(var M=t.values(),P=M.next();!P.done;){if(I(P.value))return!0;P=M.next()}}}function indexOfElementInArray(e,t){if(!t)return-1;if(t.indexOf)return t.indexOf(e);var r=t.length,n;for(n=0;n<r;n+=1)if(t[n]===e)return n;return-1}function Node(e,t){this.id=e,this.links=null,this.data=t}function addLinkToNode(e,t){e.links?e.links.push(t):e.links=[t]}function Link(e,t,r,n){this.fromId=e,this.toId=t,this.data=r,this.id=n}function makeLinkId(e,t){return e.toString()+"\u{1F449} "+t.toString()}function getDelaunayGraph(e){const r=Delaunator.from(e).triangles,n=ngraph_graph();e.forEach(a=>{n.addNode(a.id,a)});for(let a=r.length;a;){--a;const o=e[r[a]];--a;const i=e[r[a]];--a;const u=e[r[a]];addTriangulationLink(o.id,i.id,n),addTriangulationLink(i.id,u.id,n),addTriangulationLink(u.id,o.id,n)}return n}function addTriangulationLink(e,t,r){r.addLink(e,t)}function makeSpanningTree(e){const t=ngraph_graph();e.forEach(n=>{t.addLink(n.from.id,n.to.id)});const r=e[0].from.id;return{getGraph(){return t},getRootId(){return r},get(n){return t.gentNode(n)}}}class EdgeModel{constructor(t,r){this.from=t,this.to=r}}function removeOverlaps(e,t){const r=[];t=t||{};const n=t.canMove||yes,a=t.pullX||!1,o=t.pullY||!1;if(e.size<2)return;if(e.size===2){let _=Array.from(e).map(x=>x[1]);d(_[0],_[1]);return}e.forEach(_=>{const x=[_.cx,_.cy];x.id=_.id,r.push(x)});const i=getDelaunayGraph(r);i.forEachLink(v);const f=ngraph_kruskal(i,_=>_.data).map(_=>new EdgeModel(l(_.fromId),l(_.toId)));let c;f.length>0&&(c=makeSpanningTree(f),s(c));return;function l(_){return e.get(_)}function s(_){const x=_.getGraph(),y=new Set;k(_.getRootId());function k(V){if(y.has(V))return;y.add(V);const q=l(V);x.forEachLinkedNode(V,L=>{if(y.has(L.id))return;const T=l(L.id);d(q,T),k(L.id)})}}function d(_,x){if(m(_,x)){let y=h(_,x),k=x.cx-_.cx,V=x.cy-_.cy;Number.isFinite(y)||(y=1,k=.001,V=-.001),n(x.id)?(x.cx=_.cx+y*k,x.cy=_.cy+y*V):(_.cx=x.cx-y*k,_.cy=x.cy-y*V)}}function h(_,x){const y=Math.abs(_.cx-x.cx),k=Math.abs(_.cy-x.cy),V=(_.width+x.width)/2,q=(_.height+x.height)/2;return Math.min(V/y,q/k)}function v(_){const x=l(_.fromId),y=l(_.toId),k=g(x,y);_.data=k}function g(_,x){if(m(_,x)){const y=S(_,x);return-(h(_,x)-1)*y}return E(_,x)}function m(_,x){return a?!0:_.left>x.right||x.left>_.right?a:_.top>x.bottom||x.top>_.bottom?o:!0}function E(_,x){if(m(_,x))return 0;let y=0,k=0;return _.right<x.left?y=x.right-_.left:x.right<_.left&&(y=_.left-x.right),_.top<x.bottom?k=x.bottom-_.top:x.top<_.bottom&&(k=_.bottom-x.top),Math.sqrt(y*y+k*k)}function S(_,x){const y=_.cx-x.cx,k=_.cy-x.cy;return Math.sqrt(y*y+k*k)}}function yes(){return!0}class Rect{constructor(t){if(Object.assign(this,t),!isNumber(this.left))throw new Error("Left is wrong");if(!isNumber(this.top))throw new Error("top is wrong");if(!isNumber(this.width))throw new Error("width is wrong");if(!isNumber(this.height))throw new Error("height is wrong")}inflate(t){this.left+=t*this.width/2,this.top+=t*this.height/2,this.width*=t,this.height*=t}get right(){return this.left+this.width}get bottom(){return this.top+this.height}get cx(){return this.left+this.width/2}get cy(){return this.top+this.height/2}set cx(t){this.left=t-this.width/2}set cy(t){this.top=t-this.height/2}}function isNumber(e){return!!Number.isFinite(e)}var ngraph_forcelayout={exports:{}},spring=Spring;function Spring(e,t,r,n){this.from=e,this.to=t,this.length=r,this.coeff=n}var ngraph_expose=exposeProperties;function exposeProperties(e,t,r){var n=Object.prototype.toString.call(r)==="[object Array]";if(n)for(var a=0;a<r.length;++a)augment$1(e,t,r[a]);else for(var o in e)augment$1(e,t,o)}function augment$1(e,t,r){if(e.hasOwnProperty(r)){if(typeof t[r]=="function")return;t[r]=function(n){return n!==void 0?(e[r]=n,t):e[r]}}}var ngraph_merge=merge;function merge(e,t){var r;if(e||(e={}),t){for(r in t)if(t.hasOwnProperty(r)){var n=e.hasOwnProperty(r),a=typeof t[r],o=!n||typeof e[r]!==a;o?e[r]=t[r]:a==="object"&&(e[r]=merge(e[r],t[r]))}}return e}var node=function(){this.body=null,this.quad0=null,this.quad1=null,this.quad2=null,this.quad3=null,this.mass=0,this.massX=0,this.massY=0,this.left=0,this.top=0,this.bottom=0,this.right=0},insertStack=InsertStack;function InsertStack(){this.stack=[],this.popIdx=0}InsertStack.prototype={isEmpty:function(){return this.popIdx===0},push:function(e,t){var r=this.stack[this.popIdx];r?(r.node=e,r.body=t):this.stack[this.popIdx]=new InsertStackElement(e,t),++this.popIdx},pop:function(){if(this.popIdx>0)return this.stack[--this.popIdx]},reset:function(){this.popIdx=0}};function InsertStackElement(e,t){this.node=e,this.body=t}var isSamePosition=function(t,r){var n=Math.abs(t.x-r.x),a=Math.abs(t.y-r.y);return n<1e-8&&a<1e-8},ngraph_quadtreebh=function(e){e=e||{},e.gravity=typeof e.gravity=="number"?e.gravity:-1,e.theta=typeof e.theta=="number"?e.theta:.8;var t=ngraph_random.exports.random(1984),r=node,n=insertStack,a=isSamePosition,o=e.gravity,i=[],u=new n,f=e.theta,c=[],l=0,s=d();return{insertBodies:v,getRoot:function(){return s},updateBodyForce:h,options:function(m){return m?(typeof m.gravity=="number"&&(o=m.gravity),typeof m.theta=="number"&&(f=m.theta),this):{gravity:o,theta:f}}};function d(){var m=c[l];return m?(m.quad0=null,m.quad1=null,m.quad2=null,m.quad3=null,m.body=null,m.mass=m.massX=m.massY=0,m.left=m.right=m.top=m.bottom=0):(m=new r,c[l]=m),++l,m}function h(m){var E=i,S,_,x,y,k=0,V=0,q=1,L=0,T=1;for(E[0]=s;q;){var N=E[L],G=N.body;q-=1,L+=1;var b=G!==m;G&&b?(_=G.pos.x-m.pos.x,x=G.pos.y-m.pos.y,y=Math.sqrt(_*_+x*x),y===0&&(_=(t.nextDouble()-.5)/50,x=(t.nextDouble()-.5)/50,y=Math.sqrt(_*_+x*x)),S=o*G.mass*m.mass/(y*y*y),k+=S*_,V+=S*x):b&&(_=N.massX/N.mass-m.pos.x,x=N.massY/N.mass-m.pos.y,y=Math.sqrt(_*_+x*x),y===0&&(_=(t.nextDouble()-.5)/50,x=(t.nextDouble()-.5)/50,y=Math.sqrt(_*_+x*x)),(N.right-N.left)/y<f?(S=o*N.mass*m.mass/(y*y*y),k+=S*_,V+=S*x):(N.quad0&&(E[T]=N.quad0,q+=1,T+=1),N.quad1&&(E[T]=N.quad1,q+=1,T+=1),N.quad2&&(E[T]=N.quad2,q+=1,T+=1),N.quad3&&(E[T]=N.quad3,q+=1,T+=1)))}m.force.x+=k,m.force.y+=V}function v(m){var E=Number.MAX_VALUE,S=Number.MAX_VALUE,_=Number.MIN_VALUE,x=Number.MIN_VALUE,y,k=m.length;for(y=k;y--;){var V=m[y].pos.x,q=m[y].pos.y;V<E&&(E=V),V>_&&(_=V),q<S&&(S=q),q>x&&(x=q)}var L=_-E,T=x-S;for(L>T?x=S+L:_=E+T,l=0,s=d(),s.left=E,s.right=_,s.top=S,s.bottom=x,y=k-1,y>=0&&(s.body=m[y]);y--;)g(m[y])}function g(m){for(u.reset(),u.push(s,m);!u.isEmpty();){var E=u.pop(),S=E.node,_=E.body;if(S.body){var G=S.body;if(S.body=null,a(G.pos,_.pos)){var b=3;do{var $=t.nextDouble(),j=(S.right-S.left)*$,W=(S.bottom-S.top)*$;G.pos.x=S.left+j,G.pos.y=S.top+W,b-=1}while(b>0&&a(G.pos,_.pos));if(b===0&&a(G.pos,_.pos))return}u.push(S,G),u.push(S,_)}else{var x=_.pos.x,y=_.pos.y;S.mass=S.mass+_.mass,S.massX=S.massX+_.mass*x,S.massY=S.massY+_.mass*y;var k=0,V=S.left,q=(S.right+V)/2,L=S.top,T=(S.bottom+L)/2;x>q&&(k=k+1,V=q,q=S.right),y>T&&(k=k+2,L=T,T=S.bottom);var N=getChild(S,k);N?u.push(N,_):(N=d(),N.left=V,N.top=L,N.right=q,N.bottom=T,N.body=_,setChild(S,k,N))}}}};function getChild(e,t){return t===0?e.quad0:t===1?e.quad1:t===2?e.quad2:t===3?e.quad3:null}function setChild(e,t,r){t===0?e.quad0=r:t===1?e.quad1=r:t===2?e.quad2=r:t===3&&(e.quad3=r)}var bounds=function(e,t){var r=ngraph_random.exports.random(42),n={x1:0,y1:0,x2:0,y2:0};return{box:n,update:a,reset:function(){n.x1=n.y1=0,n.x2=n.y2=0},getBestNewPosition:function(o){var i=n,u=0,f=0;if(o.length){for(var c=0;c<o.length;++c)u+=o[c].pos.x,f+=o[c].pos.y;u/=o.length,f/=o.length}else u=(i.x1+i.x2)/2,f=(i.y1+i.y2)/2;var l=t.springLength;return{x:u+r.next(l)-l/2,y:f+r.next(l)-l/2}}};function a(){var o=e.length;if(o!==0){for(var i=Number.MAX_VALUE,u=Number.MAX_VALUE,f=Number.MIN_VALUE,c=Number.MIN_VALUE;o--;){var l=e[o];l.isPinned?(l.pos.x=l.prevPos.x,l.pos.y=l.prevPos.y):(l.prevPos.x=l.pos.x,l.prevPos.y=l.pos.y),l.pos.x<i&&(i=l.pos.x),l.pos.x>f&&(f=l.pos.x),l.pos.y<u&&(u=l.pos.y),l.pos.y>c&&(c=l.pos.y)}n.x1=i,n.x2=f,n.y1=u,n.y2=c}}},dragForce=function(e){var t=ngraph_merge,r=ngraph_expose;e=t(e,{dragCoeff:.02});var n={update:function(a){a.force.x-=e.dragCoeff*a.velocity.x,a.force.y-=e.dragCoeff*a.velocity.y}};return r(e,n,["dragCoeff"]),n},springForce=function(e){var t=ngraph_merge,r=ngraph_random.exports.random(42),n=ngraph_expose;e=t(e,{springCoeff:.8,springLength:80});var a={update:function(o){var i=o.from,u=o.to,f=o.length<0?e.springLength:o.length,c=u.pos.x-i.pos.x,l=u.pos.y-i.pos.y,s=Math.sqrt(c*c+l*l);s===0&&(c=(r.nextDouble()-.5)/50,l=(r.nextDouble()-.5)/50,s=Math.sqrt(c*c+l*l));var d=s-f,h=(!o.coeff||o.coeff<0?e.springCoeff:o.coeff)*d/s;i.force.x+=h*c,i.force.y+=h*l,i.springCount+=1,i.springLength+=s,u.force.x-=h*c,u.force.y-=h*l,u.springCount+=1,u.springLength+=s}};return n(e,a,["springCoeff","springLength"]),a},eulerIntegrator=integrate;function integrate(e,t,r){var n=0,a=0,o=0,i=0,u,f=e.length;if(f===0)return 0;for(u=0;u<f;++u){var c=e[u];r&&c.springCount&&(t=r*c.springLength/c.springCount);var l=t/c.mass;c.velocity.x+=l*c.force.x,c.velocity.y+=l*c.force.y;var s=c.velocity.x,d=c.velocity.y,h=Math.sqrt(s*s+d*d);h>1&&(c.velocity.x=s/h,c.velocity.y=d/h),n=t*c.velocity.x,o=t*c.velocity.y,c.pos.x+=n,c.pos.y+=o,a+=Math.abs(n),i+=Math.abs(o)}return(a*a+i*i)/f}var primitives={Body,Vector2d,Body3d,Vector3d};function Body(e,t){this.pos=new Vector2d(e,t),this.prevPos=new Vector2d(e,t),this.force=new Vector2d,this.velocity=new Vector2d,this.mass=1,this.springCount=0,this.springLength=0}Body.prototype.reset=function(){this.force.reset(),this.springCount=0,this.springLength=0};Body.prototype.setPosition=function(e,t){this.prevPos.x=this.pos.x=e,this.prevPos.y=this.pos.y=t};function Vector2d(e,t){e&&typeof e!="number"?(this.x=typeof e.x=="number"?e.x:0,this.y=typeof e.y=="number"?e.y:0):(this.x=typeof e=="number"?e:0,this.y=typeof t=="number"?t:0)}Vector2d.prototype.reset=function(){this.x=this.y=0};function Body3d(e,t,r){this.pos=new Vector3d(e,t,r),this.prevPos=new Vector3d(e,t,r),this.force=new Vector3d,this.velocity=new Vector3d,this.mass=1,this.springCount=0,this.springLength=0}Body3d.prototype.reset=function(){this.force.reset(),this.springCount=0,this.springLength=0};Body3d.prototype.setPosition=function(e,t,r){this.prevPos.x=this.pos.x=e,this.prevPos.y=this.pos.y=t,this.prevPos.z=this.pos.z=r};function Vector3d(e,t,r){e&&typeof e!="number"?(this.x=typeof e.x=="number"?e.x:0,this.y=typeof e.y=="number"?e.y:0,this.z=typeof e.z=="number"?e.z:0):(this.x=typeof e=="number"?e:0,this.y=typeof t=="number"?t:0,this.z=typeof r=="number"?r:0)}Vector3d.prototype.reset=function(){this.x=this.y=this.z=0};var physics=primitives,createBody=function(e){return new physics.Body(e)},physicsSimulator_1=physicsSimulator;function physicsSimulator(e){var t=spring,r=ngraph_expose,n=ngraph_merge,a=ngraph_events$2;e=n(e,{springLength:10,springCoeff:.8,gravity:-12,theta:.8,dragCoeff:.9,timeStep:.5,adaptiveTimeStepWeight:0});var o=e.createQuadTree||ngraph_quadtreebh,i=e.createBounds||bounds,u=e.createDragForce||dragForce,f=e.createSpringForce||springForce,c=e.integrator||eulerIntegrator,l=e.createBody||createBody,s=[],d=[],h=o(e),v=i(s,e),g=f(e),m=u(e),E=!0,S=0,_={bodies:s,quadTree:h,springs:d,settings:e,step:function(){x();var y=c(s,e.timeStep,e.adaptiveTimeStepWeight);return v.update(),y},addBody:function(y){if(!y)throw new Error("Body is required");return s.push(y),y},addBodyAt:function(y){if(!y)throw new Error("Body position is required");var k=l(y);return s.push(k),k},removeBody:function(y){if(!!y){var k=s.indexOf(y);if(!(k<0))return s.splice(k,1),s.length===0&&v.reset(),!0}},addSpring:function(y,k,V,q){if(!y||!k)throw new Error("Cannot add null spring to force simulator");typeof V!="number"&&(V=-1);var L=new t(y,k,V,q>=0?q:-1);return d.push(L),L},getTotalMovement:function(){return S},removeSpring:function(y){if(!!y){var k=d.indexOf(y);if(k>-1)return d.splice(k,1),!0}},getBestNewBodyPosition:function(y){return v.getBestNewPosition(y)},getBBox:function(){return E&&(v.update(),E=!1),v.box},invalidateBBox:function(){E=!0},gravity:function(y){return y!==void 0?(e.gravity=y,h.options({gravity:y}),this):e.gravity},theta:function(y){return y!==void 0?(e.theta=y,h.options({theta:y}),this):e.theta}};return r(e,_),a(_),_;function x(){var y,k=s.length;if(k)for(h.insertBodies(s);k--;)y=s[k],y.isPinned||(y.reset(),h.updateBodyForce(y),m.update(y));for(k=d.length;k--;)g.update(d[k])}}ngraph_forcelayout.exports=createLayout;ngraph_forcelayout.exports.simulator=physicsSimulator_1;var eventify$1=ngraph_events$2;function createLayout(e,t){if(!e)throw new Error("Graph structure cannot be undefined");var r=t&&t.createSimulator||physicsSimulator_1,n=r(t);if(Array.isArray(t))throw new Error("Physics settings is expected to be an object");var a=G;t&&typeof t.nodeMass=="function"&&(a=t.nodeMass);var o=new Map,i={},u=0,f=n.settings.springTransform||noop;_(),m();var c=!1,l={step:function(){if(u===0)return s(!0),!0;var b=n.step();l.lastMove=b,l.fire("step");var $=b/u,j=$<=.01;return s(j),j},getNodePosition:function(b){return N(b).pos},setNodePosition:function(b){var $=N(b);$.setPosition.apply($,Array.prototype.slice.call(arguments,1)),n.invalidateBBox()},getLinkPosition:function(b){var $=i[b];if($)return{from:$.from.pos,to:$.to.pos}},getGraphRect:function(){return n.getBBox()},forEachBody:d,pinNode:function(b,$){var j=N(b.id);j.isPinned=!!$},isNodePinned:function(b){return N(b.id).isPinned},dispose:function(){e.off("changed",S),l.fire("disposed")},getBody:g,getSpring:v,getForceVectorLength:h,simulator:n,graph:e,lastMove:0};return eventify$1(l),l;function s(b){c!==b&&(c=b,E(b))}function d(b){o.forEach(function($,j){b($,j)})}function h(){let b=0,$=0;return d(j=>{b+=Math.abs(j.force.x),$+=Math.abs(j.force.y)}),Math.sqrt(b*b+$*$)}function v(b,$){var j;if($===void 0)typeof b!="object"?j=b:j=b.id;else{var W=e.hasLink(b,$);if(!W)return;j=W.id}return i[j]}function g(b){return o.get(b)}function m(){e.on("changed",S)}function E(b){l.fire("stable",b)}function S(b){for(var $=0;$<b.length;++$){var j=b[$];j.changeType==="add"?(j.node&&x(j.node.id),j.link&&k(j.link)):j.changeType==="remove"&&(j.node&&y(j.node),j.link&&V(j.link))}u=e.getNodesCount()}function _(){u=0,e.forEachNode(function(b){x(b.id),u+=1}),e.forEachLink(k)}function x(b){var $=o.get(b);if(!$){var j=e.getNode(b);if(!j)throw new Error("initBody() was called with unknown node id");var W=j.position;if(!W){var U=q(j);W=n.getBestNewBodyPosition(U)}$=n.addBodyAt(W),$.id=b,o.set(b,$),L(b),T(j)&&($.isPinned=!0)}}function y(b){var $=b.id,j=o.get($);j&&(o.delete($),n.removeBody(j))}function k(b){L(b.fromId),L(b.toId);var $=o.get(b.fromId),j=o.get(b.toId),W=n.addSpring($,j,b.length);f(b,W),i[b.id]=W}function V(b){var $=i[b.id];if($){var j=e.getNode(b.fromId),W=e.getNode(b.toId);j&&L(j.id),W&&L(W.id),delete i[b.id],n.removeSpring($)}}function q(b){var $=[];if(!b.links)return $;for(var j=Math.min(b.links.length,2),W=0;W<j;++W){var U=b.links[W],Z=U.fromId!==b.id?o.get(U.fromId):o.get(U.toId);Z&&Z.pos&&$.push(Z)}return $}function L(b){var $=o.get(b);if($.mass=a(b),Number.isNaN($.mass))throw new Error("Node mass should be a number")}function T(b){return b&&(b.isPinned||b.data&&b.data.isPinned)}function N(b){var $=o.get(b);return $||(x(b),$=o.get(b)),$}function G(b){var $=e.getLinks(b);return $?1+$.length/3:1}}function noop(){}var createLayout$1=ngraph_forcelayout.exports;const USE_FAKE=1,USE_INTERPOLATE=2,REMOVE_OVERLAPS=3,USE_REAL=4;function createAggregateLayout(e,t){const r=e.maxDepth;let n=V(),a=createFakeLayout(e),o=createInterpolateLayout(a,n),i=!1,u=0,f=0,c=2e3,l=2e3,s=USE_FAKE,d=new Map;var h=ngraph_events$2({step:S,pinNode:k,getNodePosition:E,addNode:m,setGraphReady:v,getGraphReady:g});return h;function v(){u=0,f=0,i=!0}function g(){return i}function m(q,L){a.addNode(q,L),d.set(q,L)}function E(q){if(s===USE_FAKE||s===REMOVE_OVERLAPS)return a.getNodePosition(q);if(s===USE_REAL)return n.getNodePosition(q);if(s===USE_INTERPOLATE)return o.getNodePosition(q)}function S(){if(!i||u<c){s=USE_FAKE;let q=window.performance.now();a.step();do n.step(),u+=1;while(window.performance.now()-q<10);f+=window.performance.now()-q,f>l&&(u=c);const L=Math.min(1,Math.max(f/l,u/c));return _(),t.setLayoutCompletion(Math.round(L*100)),u>=c&&(s=REMOVE_OVERLAPS),!0}else{if(s===REMOVE_OVERLAPS)return x(),s=USE_INTERPOLATE,!0;if(s===USE_INTERPOLATE)return o.step(),o.done()&&(s=USE_REAL,h.fire("ready",h)),!0}return!1}function _(){e.forEachNode(function(q){var L=n.getNodePosition(q.id);a.setDesiredNodePosition(q.id,L)})}function x(){let q=y();removeOverlaps(q),removeOverlaps(q),removeOverlaps(q),q.forEach((L,T)=>{n.setNodePosition(T,L.left-L.dx,L.top-L.dy)})}function y(){let q=new Map;return d.forEach((L,T)=>{let N=n.getNodePosition(T),{width:G,height:b}=L;const $=new Rect({id:T,left:N.x+L.x,top:N.y+L.y,dx:L.x,dy:L.y,width:G,height:b});q.set(T,$)}),q}function k(q){n.pinNode(q,!0)}function V(){return createLayout$1(e,{springLength:20,springCoeff:.002,gravity:-1.2,theta:.8,dragCoeff:.02,timeStep:14,nodeMass(q){let L=e.getLinks(q),T=L?L.length:1,N=e.getNode(q);return T*=r-N.data.depth+1,q.length*T}})}}var domparser=createDomparser();function createDomparser(){return typeof DOMParser=="undefined"?{parseFromString:fail}:new DOMParser}function fail(){throw new Error("DOMParser is not supported by this platform. Please open issue here https://github.com/anvaka/simplesvg")}var parser=domparser,svg$1=simplesvg,compile_1=compile;function compile(e){try{return e=addNamespaces(e),svg$1(parser.parseFromString(e,"text/xml").documentElement)}catch(t){throw t}}function addNamespaces(e){if(!!e){var t='xmlns:svg="http://www.w3.org/2000/svg" xmlns="http://www.w3.org/2000/svg"',r=e.match(/^<\w+/);if(r){var n=r[0].length;return e.substr(0,n)+" "+t+" "+e.substr(n)}else throw new Error("Cannot parse input text: invalid xml?")}}var compile_template=template,BINDING_EXPR=/{{(.+?)}}/;function template(e){var t=Object.create(null);return extractAllBindings(e,t),{link:function(r){Object.keys(t).forEach(function(a){var o=t[a];o.forEach(n)});function n(a){a(r)}}}}function extractAllBindings(e,t){var r=e.nodeType,n=r===1||r===3;if(!!n){var a;if(e.hasChildNodes()){var o=e.childNodes;for(a=0;a<o.length;++a)extractAllBindings(o[a],t)}if(r===3&&bindTextContent(e,t),!!e.attributes){var i=e.attributes;for(a=0;a<i.length;++a)bindDomAttribute(i[a],e,t)}}}function bindDomAttribute(e,t,r){var n=e.value;if(!n)return;var a=n.match(BINDING_EXPR);if(!a)return;var o=e.localName,i=a[1],u=i.indexOf(".")<0;if(!u)throw new Error("simplesvg currently does not support nested bindings");var f=r[i];f?f.push(c):f=r[i]=[c];function c(l){t.setAttributeNS(null,o,l[i])}}function bindTextContent(e,t){var r=e.nodeValue;if(!r)return;var n=r.match(BINDING_EXPR);if(!n)return;var a=n[1];a.indexOf(".")<0;var o=t[a];o?o.push(i):o=t[a]=[i];function i(u){e.nodeValue=u[a]}}addEventListener.removeEventListener=removeEventListener;addEventListener.addEventListener=addEventListener;var addEventListener_1=addEventListener,Events=null;function addEventListener(e,t,r,n){return Events=Events||(document.addEventListener?{add:stdAttach,rm:stdDetach}:{add:oldIEAttach,rm:oldIEDetach}),Events.add(e,t,r,n)}function removeEventListener(e,t,r,n){return Events=Events||(document.addEventListener?{add:stdAttach,rm:stdDetach}:{add:oldIEAttach,rm:oldIEDetach}),Events.rm(e,t,r,n)}function stdAttach(e,t,r,n){e.addEventListener(t,r,n)}function stdDetach(e,t,r,n){e.removeEventListener(t,r,n)}function oldIEAttach(e,t,r,n){if(n)throw new Error("cannot useCapture in oldIE");e.attachEvent("on"+t,r)}function oldIEDetach(e,t,r,n){e.detachEvent("on"+t,r)}var simplesvg=svg;svg.compile=compile_1;var compileTemplate=svg.compileTemplate=compile_template,domEvents=addEventListener_1,svgns="http://www.w3.org/2000/svg",xlinkns="http://www.w3.org/1999/xlink";function svg(e,t){var r=augment(e);return t===void 0||r.attr(t),r}function augment(e){var t=e;if(typeof e=="string")t=window.document.createElementNS(svgns,e);else if(e.simplesvg)return e;var r;return t.simplesvg=!0,t.attr=u,t.append=i,t.link=f,t.text=c,t.on=a,t.off=o,t.dataSource=n,t;function n(l){return r||(r=compileTemplate(t)),r.link(l),t}function a(l,s,d){return domEvents.addEventListener(t,l,s,d),t}function o(l,s,d){return domEvents.removeEventListener(t,l,s,d),t}function i(l){var s=svg(l);return t.appendChild(s),s}function u(l,s){if(arguments.length===2)return s!==null?t.setAttributeNS(null,l,s):t.removeAttributeNS(null,l),t;if(typeof l=="string")return t.getAttributeNS(null,l);if(typeof l!="object")throw new Error("attr() expects to have either string or object as first argument");for(var d=l,h=Object.keys(d),v=0;v<h.length;++v){var g=h[v],s=d[g];g==="link"?t.link(s):t.attr(g,s)}return t}function f(l){return arguments.length?(t.setAttributeNS(xlinkns,"xlink:href",l),t):t.getAttributeNS(xlinkns,"xlink:href")}function c(l){return l!==void 0?(t.textContent=l,t):t.textContent}}let random=ngRandom(42);function createLinkAnimator(e,t,r){const n=new Map;let a=new Map;const o=[];let i=20,u=e.maxDepth;e.forEachLink(h),o.sort((g,m)=>d(g)-d(m));let f=requestAnimationFrame(l);return{getLinkInfo:s,dispose:c};function c(){f&&(cancelAnimationFrame(f),f=null)}function l(){for(;a.size<i&&o.length>0;){let g=o.pop(),m=Math.round(Math.abs(random.gaussian()*10))+1;a.set(g.id,v(g,m))}a.forEach(function(g,m){g.step(),g.isDone&&a.delete(m)}),(o.length>0||a.size>0)&&(f=requestAnimationFrame(l))}function s(g){return n.get(g)}function d(g){let m=e.getNode(g.fromId).data,E=e.getNode(g.toId).data;const S=(m.depth+E.depth)/2;return(u-S)/u}function h(g){o.push(g)}function v(g,m){var E=0;let S=t.getNodePosition(g.fromId),_=t.getNodePosition(g.toId);const x=d(g),y=8*x+2,k=Math.round((200-75)*(1-x)+75);let V={step:q,isDone:!1};return V;function q(){let L=ease(E/m),T=S.x*(1-L)+_.x*L,N=S.y*(1-L)+_.y*L,G=n.get(g.id),b=`M${S.x},${S.y} L${T},${N}`;if(G)G.ui.attr("d",b);else{const $=simplesvg("path",{class:"link-ui",id:g.id,"stroke-width":y,fill:"black",stroke:`rgb(${k}, ${k}, ${k})`,d:b});r.appendChild($),n.set(g.id,{ui:$,link:g})}E+=1,E>m&&(V.isDone=!0)}}}function ease(e){return e*(2-e)}function createRenderer(e){const t=document.querySelector("#scene"),r=t.querySelector("#nodes"),n=t.querySelector("#edges"),a={isVisible:!1},o=document.querySelector("svg");o.createSVGPoint();const i=panzoom(t),u={left:-500,right:500,top:-500,bottom:500};i.showRectangle(u);let f=new Map,c,l,s=0,d,h=createTextMeasure(t);return bus.on("graph-ready",q),{render:V,dispose:v};function v(){G(),bus.off("graph-ready",q)}function g(P){let F=S(P);F?_(F,P.clientX,P.clientY):x()}function m(P,F){}function E(P){let F=S(P);F&&bus.fire("show-details",F.link)}function S(P){const F=P.target&&P.target.id;let H=d.getLinkInfo(F);if(!H){let O=(P.clientX,P.clientY,void 0);H=d.getLinkInfo(O)}return H}function _(P,F,H){const{fromId:O,toId:K}=P.link;bus.fire("show-tooltip",{isVisible:!0,from:O,to:K,x:F,y:H}),y(),f.get(O).classList.add("hovered"),f.get(K).classList.add("hovered"),P.ui.classList.add("hovered")}function x(){bus.fire("show-tooltip",a),y()}function y(){t.querySelectorAll(".hovered").forEach(k)}function k(P){P.classList.remove("hovered")}function V(P){G(),l=P,c=createAggregateLayout(l,e),c.on("ready",N),f=new Map,l.forEachNode($),l.on("changed",T),cancelAnimationFrame(s),s=requestAnimationFrame(L)}function q(P){P===l&&(c.setGraphReady(),e.startLayout())}function L(){c.step()&&(s=requestAnimationFrame(L)),I()}function T(P){P.forEach(F=>{F.changeType==="add"&&F.node&&$(F.node)})}function N(){e.done(),d=createLinkAnimator(l,c,n)}function G(){b(r),b(n),document.removeEventListener("mousemove",g),o.removeEventListener("click",E),c&&c.off("ready",N),l&&l.off("changed",T),d&&d.dispose()}function b(P){for(;P.lastChild;)P.removeChild(P.lastChild)}function $(P){const F=(l.maxDepth-P.data.depth)/l.maxDepth;let H=M(P.id);P.data.depth===0&&c.pinNode(P);const O=Z(P.id,F);c.addNode(P.id,O);const K={x:O.x,y:O.y,width:O.width,height:O.height,rx:O.rx,ry:O.ry,fill:"white","stroke-width":O.strokeWidth,stroke:"#58585A"},te={"font-size":O.fontSize,x:O.px,y:O.py},ne=simplesvg("rect",K),ae=simplesvg("text",te);ae.text(P.id);const Q=simplesvg("g",{transform:`translate(${H.x}, ${H.y})`});Q.appendChild(ne),Q.appendChild(ae),r.appendChild(Q),f.set(P.id,Q);let re,se=X=>{re=!0},ue=X=>{re=!1,W(),Q.addEventListener("mousemove",se)},ce=X=>{re||X.button===0&&j(X,P),re=!1,Q.removeEventListener("mousemove",se)};Q.addEventListener("mousedown",ue),Q.addEventListener("mouseup",ce),Q.addEventListener("contextmenu",X=>{X.button==2&&(X.preventDefault(),bus.fire("node-click-right",{node:P}))}),Q.addEventListener("mouseenter",X=>{re||U(X,P)}),Q.addEventListener("mouseleave",X=>W())}function j(P,F){bus.fire("show-details-node",{node:F})}function W(P,F){y(),bus.fire("show-tooltip-node",{node:null})}function U(P,F){var K;const H=P.target;O(H),(K=F.links)!=null&&K.length&&F.links.forEach(te=>{const ne=d.getLinkInfo(te.id);O(ne.ui);const ae=te.fromId!==F.id?te.fromId:te.toId,Q=f.get(ae);O(Q)});function O(te){te.classList.add("hovered")}bus.fire("show-tooltip-node",{node:F,x:P.clientX,y:P.clientY})}function Z(P,F){const H=45*F+14,O=h(P,H),K=O.totalWidth+O.spaceWidth*6,te=H*1.6;return{fontSize:H,width:K,height:te,x:-K/2,y:-te/2,rx:15*F+2,ry:15*F+2,px:-K/2+O.spaceWidth*3,py:-te/2+H*1.1,strokeWidth:4*F+1}}function I(){f.forEach((P,F)=>{let H=M(F);P.attr("transform",`translate(${H.x}, ${H.y})`)})}function M(P){return c.getNodePosition(P)}}function buildGraph(e,t,r,n,a){if(console.log("\u{1F680} buildGraph: entryItem, MAX_DEPTH, progress",e,n,a),!e||(e.id=e.id&&e.id.trim(),!e.id))return;let o=!1,i,u=ngraph_graph();u.maxDepth=n;let f=[],c=300+Math.random()*100;return a.startDownload(),s(),{dispose:l,graph:u};function l(){o=!0,i&&(i=null)}function s(){u.addNode(e.id,je({depth:0},e.data)),v(e.id)}function d(m,E){var S=u.getNode(m);if(!S)throw new Error("Parent is missing for "+m);E.forEach(_=>{const x=r(_),y=u.hasNode(x.id),k=u.getLink(x.id,m)||u.getLink(m,x.id);if(y){k||u.addLink(m,x.id);return}let V=S.data.depth+1;u.addNode(x.id,je({depth:V},x.data)),u.addLink(m,x.id),V<n&&f.push(x.id)}),setTimeout(h,c)}function h(){if(!o){if(f.length===0){bus.fire("graph-ready",u);return}for(;f.length>0;){let m=f.shift();v(m),a.updateLayout(f.length,m)}}}function v(m){i=t(m),i.then(E=>g(E,m)).catch(E=>{const S="Failed to download "+m+"; Message: "+E;console.error(S),a.downloadError(S),h()})}function g(m,E){if(m.length===0)throw console.warn("[onPendingReady] Got empty [] result! query:",E),Error("got empty result []!");d(E,m)}}class Progress{constructor(){this.message="",this.phase="none",this.download={errors:[],remaining:0,currentWord:""},this.layout={iteration:0},this.working=!0}startDownload(){this.phase="download"}startLayout(){this.message="Finished download. Constructing layout...",this.phase="layout"}setLayoutCompletion(t){this.phase==="layout"&&(this.message=`Finished download. Constructing layout ${t}%...`)}updateLayout(t,r){this.download.currentWord=r,this.download.remaining=t,this.message=`Remaining: ${t}. Downloading ${r}`}done(){this.working=!1}downloadError(t){this.download.errors.push(t)}reset(){this.phase="none",this.download.errors=[],this.download.remaining=0,this.download.currentWord="",this.layout.iteration=0,this.message="",this.working=!0}}var ngraph_events=function(e){validateSubject(e);var t=createEventsStorage(e);return e.on=t.on,e.off=t.off,e.fire=t.fire,e};function createEventsStorage(e){var t=Object.create(null);return{on:function(r,n,a){if(typeof n!="function")throw new Error("callback is expected to be a function");var o=t[r];return o||(o=t[r]=[]),o.push({callback:n,ctx:a}),e},off:function(r,n){var a=typeof r=="undefined";if(a)return t=Object.create(null),e;if(t[r]){var o=typeof n!="function";if(o)delete t[r];else for(var i=t[r],u=0;u<i.length;++u)i[u].callback===n&&i.splice(u,1)}return e},fire:function(r){var n=t[r];if(!n)return e;var a;arguments.length>1&&(a=Array.prototype.splice.call(arguments,1));for(var o=0;o<n.length;++o){var i=n[o];i.callback.apply(i.ctx,a)}return e}}}function validateSubject(e){if(!e)throw new Error("Eventify cannot use falsy object as events subject");for(var t=["on","fire","off"],r=0;r<t.length;++r)if(e.hasOwnProperty(t[r]))throw new Error("Subject cannot be eventified, since it already has property '"+t[r]+"'")}var inMemoryHistory_1=inMemoryHistory$1;function inMemoryHistory$1(e){var t=[],r=e;return{dispose:o,onChanged:i,set:a,get:n};function n(){return r}function a(f){r=f,setTimeout(function(){u(f)},0)}function o(){t=[]}function i(f){if(typeof f!="function")throw new Error("changeCallback should be a function");t.push(f)}function u(f){t.forEach(function(c){c(f)})}}var query$1={parse:parse$1,stringify};function stringify(e){if(!e)return"";return Object.keys(e).map(t).join("&");function t(r){var n=e[r],a=encodePart(r);return n!==void 0&&(a+="="+encodeValue(n)),a}}function parse$1(e){var t=Object.create(null);if(!e)return t;return e.split("&").forEach(r),t;function r(n){if(!!n){var a=n.split("=");t[decodeURIComponent(a[0])]=decodeValue(a[1])}}}function encodeValue(e){e instanceof Date&&(e=e.toISOString());var t=encodePart(e);return t}function encodePart(e){var t=encodeURIComponent(e);return t.replace(/[()]/g,saferEscape)}function saferEscape(e){return e===")"?"%29":e==="("?"%28":e}function decodeValue(e){return e=decodeURIComponent(e),e===""?e:isNaN(e)?isBolean(e)?e==="true":isISODateString(e)?new Date(e):e:parseFloat(e)}function isBolean(e){return e==="true"||e==="false"}function isISODateString(e){return e&&e.match(/(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))/)}var windowHistory_1=windowHistory$1,inMemoryHistory=inMemoryHistory_1,query=query$1;function windowHistory$1(e,t){if(typeof window=="undefined")return inMemoryHistory(e);var r=[],n=t&&t.useSearch,a=n?"?":"#?";return t.rewriteHashToSearch&&i(),o(),{onChanged:f,dispose:c,set:u,get:d,rewriteHashToSearch:i};function o(){var h=d(),v=!1;typeof e=="object"&&e&&Object.keys(e).forEach(function(g){g in h||(h[g]=e[g],v=!0)}),v&&u(h)}function i(){var h=Object.create(null),v=window.location.search;v&&(h=Object.assign(h,query.parse(v.substr(1))));var g=window.location.hash;g&&(h=Object.assign(h,query.parse(g.substr(2)))),u(h)}function u(h){var v=a+query.stringify(h);n&&window.location.hash&&(v+=window.location.hash),window.history?window.history.replaceState(void 0,void 0,v):window.location.replace(v)}function f(h){if(typeof h!="function")throw new Error("changeCallback needs to be a function");r.length===0&&window.addEventListener("hashchange",l,!1),r.push(h)}function c(){r.length!==0&&(r=[],window.removeEventListener("hashchange",l,!1))}function l(){var h=d();s(h)}function s(h){for(var v=0;v<r.length;++v){var g=r[v];g(h)}}function d(){var h=n?window.location.search:window.location.hash,v=(h||a).substr(a.length);return query.parse(v)}}var queryState_1=queryState,eventify=ngraph_events,windowHistory=windowHistory_1;queryState.instance=instance$5;var singletonQS;function queryState(e,t){t=t||{};var r=t.history||windowHistory(e,t);validateHistoryAPI(r),r.onChanged(h);var n=r.get()||Object.create(null),a={get:l,set:s,unset:d,setIfEmpty:v,dispose:c,onChange:i,offChange:u,getHistoryObject:f},o=eventify({});return a;function i(g,m){o.on("change",g,m)}function u(g,m){o.off("change",g,m)}function f(){return r}function c(){r.dispose(),o.off()}function l(g){return g===void 0?n:n[g]}function s(g,m){var E=typeof g;return E==="object"?Object.keys(g).forEach(function(S){n[S]=g[S]}):E==="string"&&(n[g]=m),r.set(n),a}function d(g){if(g in n)return delete n[g],r.set(n),a}function h(g){n=g,o.fire("change",n)}function v(g,m){if(typeof g=="object"&&Object.keys(g).forEach(function(E){E in n||(n[E]=g[E])}),!(g in n))return n[g]=m,r.set(n),a}}function instance$5(e,t){return singletonQS?e&&singletonQS.setIfEmpty(e):singletonQS=queryState(e,t),singletonQS}function validateHistoryAPI(e){if(!e)throw new Error("history is required");if(typeof e.dispose!="function")throw new Error("dispose is required");if(typeof e.onChanged!="function")throw new Error("onChanged is required")}let lastBuilder=null;function useState(e,t){const r=queryState_1(gt(je({},t),{query:""}),{useSearch:!0}),n=r.get();console.log("[appState] appStateFromQuery:",n);let a=new Set;function o(s){return a.add(s),()=>a.delete(s)}function i(){a.clear()}function u(s){for(const d in s)typeof s[d]=="object"&&s[d]!=null&&(s[d]=u(s[d]));return new Proxy(s,{set(d,h,v,g){return a.forEach(m=>m(d,h,v)),console.log("[Proxy:appState] prop,val:",h,v),Object.prototype.hasOwnProperty.call(n,h)&&r.set(h,v),Reflect.set(d,h,v,g)}})}const f=u(je({hasGraph:!1,progress:new Progress,graph:null},n));f.maxDepth||(f.maxDepth=2),r.onChange(c),console.log("[] qs = ",r);function c(s){f.query=s.query}function l(s){return console.log("\u{1F680} ~ performSearch ~ entryItem:",s),f.hasGraph=!0,f.progress.reset(),r.set("query",s.id),lastBuilder&&lastBuilder.dispose(),lastBuilder=buildGraph(s,e.getResponse,e.getItem,f.maxDepth,f.progress),f.graph=lastBuilder.graph,lastBuilder.graph}return{qs:r,appState:f,performSearch:l,watchState:o,unwatchState:i}}var dist={exports:{}},request={},browser={exports:{}};(function(e,t){var r=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof n!="undefined")return n;throw new Error("unable to locate global object")},n=r();e.exports=t=n.fetch,n.fetch&&(t.default=n.fetch.bind(n)),t.Headers=n.Headers,t.Request=n.Request,t.Response=n.Response})(browser,browser.exports);var errors={};Object.defineProperty(errors,"__esModule",{value:!0});errors.citationError=errors.pdfError=errors.fcError=errors.eventsError=errors.mediaError=errors.relatedError=errors.introError=errors.preloadError=errors.infoboxError=errors.coordinatesError=errors.geoSearchError=errors.linksError=errors.categoriesError=errors.contentError=errors.htmlError=errors.imageError=errors.summaryError=errors.pageError=errors.searchError=errors.wikiError=void 0;class wikiError extends Error{constructor(t,r){super(t),this.name="wikiError",this.code=r}}errors.wikiError=wikiError;class searchError extends wikiError{constructor(t){super(t),this.name="searchError"}}errors.searchError=searchError;class pageError extends wikiError{constructor(t){super(t),this.name="pageError"}}errors.pageError=pageError;class summaryError extends wikiError{constructor(t){super(t),this.name="summaryError"}}errors.summaryError=summaryError;class imageError extends wikiError{constructor(t){super(t),this.name="imageError"}}errors.imageError=imageError;class htmlError extends wikiError{constructor(t){super(t),this.name="htmlError"}}errors.htmlError=htmlError;class contentError extends wikiError{constructor(t){super(t),this.name="contentError"}}errors.contentError=contentError;class categoriesError extends wikiError{constructor(t){super(t),this.name="categoriesError"}}errors.categoriesError=categoriesError;class linksError extends wikiError{constructor(t){super(t),this.name="linksError"}}errors.linksError=linksError;class geoSearchError extends wikiError{constructor(t){super(t),this.name="geoSearchError"}}errors.geoSearchError=geoSearchError;class coordinatesError extends wikiError{constructor(t){super(t),this.name="coordinatesError"}}errors.coordinatesError=coordinatesError;class infoboxError extends wikiError{constructor(t){super(t),this.name="infoboxError"}}errors.infoboxError=infoboxError;class preloadError extends wikiError{constructor(t){super(t),this.name="preloadError"}}errors.preloadError=preloadError;class introError extends wikiError{constructor(t){super(t),this.name="introError"}}errors.introError=introError;class relatedError extends wikiError{constructor(t){super(t),this.name="relatedError"}}errors.relatedError=relatedError;class mediaError extends wikiError{constructor(t){super(t),this.name="mediaError"}}errors.mediaError=mediaError;class eventsError extends wikiError{constructor(t){super(t),this.name="eventsError"}}errors.eventsError=eventsError;class fcError extends wikiError{constructor(t){super(t),this.name="featuredContentError"}}errors.fcError=fcError;class pdfError extends wikiError{constructor(t){super(t),this.name="pdfError"}}errors.pdfError=pdfError;class citationError extends wikiError{constructor(t){super(t),this.name="citationError"}}errors.citationError=citationError;Object.defineProperty(request,"__esModule",{value:!0});request.setAPIUrl=request.returnRestUrl=request.makeRestRequest=void 0;const node_fetch_1=browser.exports,errors_1$1=errors;let API_URL="https://en.wikipedia.org/w/api.php?",REST_API_URL="https://en.wikipedia.org/api/rest_v1/";const USER_AGENT="wikipedia (https://github.com/dopecodez/Wikipedia/)";async function makeRequest(e,t=!0){try{const r=je({},e);r.format="json",t&&(r.redirects=""),e.action||(r.action="query"),r.origin="*";const n={headers:{"User-Agent":USER_AGENT}};let a="";return Object.keys(r).forEach(u=>{a+=`${u}=${r[u]}&`}),await(await node_fetch_1.default(encodeURI(API_URL+a),n)).json()}catch(r){throw new errors_1$1.wikiError(r)}}async function makeRestRequest(e,t=!0){try{t||(e+="?redirect=false");const r={headers:{"User-Agent":USER_AGENT}};let a=await(await node_fetch_1.default(encodeURI(REST_API_URL+e),r)).text();try{a=JSON.parse(a)}finally{return a}}catch(r){throw new errors_1$1.wikiError(r)}}request.makeRestRequest=makeRestRequest;function returnRestUrl(e){return encodeURI(REST_API_URL+e)}request.returnRestUrl=returnRestUrl;function setAPIUrl(e){return API_URL="https://"+e.toLowerCase()+".wikipedia.org/w/api.php?",REST_API_URL="https://"+e.toLowerCase()+".wikipedia.org/api/rest_v1/",API_URL}request.setAPIUrl=setAPIUrl;request.default=makeRequest;var page={},utils={},messages={};Object.defineProperty(messages,"__esModule",{value:!0});messages.MSGS=void 0;messages.MSGS={PAGE_NOT_SUGGEST:"No page with given title suggested : ",PAGE_NOT_EXIST:"No page with given title exists : ",INFOBOX_NOT_EXIST:"Info cannot be parsed for given page"};Object.defineProperty(utils,"__esModule",{value:!0});utils.getCurrentDay=utils.getCurrentMonth=utils.getCurrentYear=utils.setPageId=utils.setPageIdOrTitleParam=utils.setTitleForPage=utils.isString=void 0;const _1=dist.exports,errors_1=errors,messages_1=messages;function isString(e){return isNaN(e)}utils.isString=isString;async function setTitleForPage(e){{const t=await _1.default.search(e,{limit:1,suggestion:!0});if(!t.suggestion&&t.results.length==0)throw new errors_1.pageError(`${messages_1.MSGS.PAGE_NOT_SUGGEST}${e}`);return e=t.suggestion||e,e}}utils.setTitleForPage=setTitleForPage;function setPageIdOrTitleParam(e,t){return isString(t)?e.titles=t:e.pageids=t,e}utils.setPageIdOrTitleParam=setPageIdOrTitleParam;function setPageId(e,t){let r;return e.pageIds?r=e.pageIds:r=Object.keys(t.query.pages)[0],r}utils.setPageId=setPageId;function getCurrentYear(){return new Date().getFullYear()}utils.getCurrentYear=getCurrentYear;function getCurrentMonth(){return new Date().getMonth()+1}utils.getCurrentMonth=getCurrentMonth;function getCurrentDay(){return new Date().getDate()}utils.getCurrentDay=getCurrentDay;function preserveCamelCase(e){let t=!1,r=!1,n=!1;for(let a=0;a<e.length;a++){const o=e[a];t&&/[a-zA-Z]/.test(o)&&o.toUpperCase()===o?(e=e.substr(0,a)+"-"+e.substr(a),t=!1,n=r,r=!0,a++):r&&n&&/[a-zA-Z]/.test(o)&&o.toLowerCase()===o?(e=e.substr(0,a-1)+"-"+e.substr(a-1),n=r,r=!1,t=!0):(t=o.toLowerCase()===o,n=r,r=o.toUpperCase()===o)}return e}var camelcase=function(e){return arguments.length>1?e=Array.from(arguments).map(r=>r.trim()).filter(r=>r.length).join("-"):e=e.trim(),e.length===0?"":e.length===1?e.toLowerCase():/^[a-z0-9]+$/.test(e)?e:(e!==e.toLowerCase()&&(e=preserveCamelCase(e)),e.replace(/^[_.\- ]+/,"").toLowerCase().replace(/[_.\- ]+(\w|$)/g,(r,n)=>n.toUpperCase()))};function _interopDefault(e){return e&&typeof e=="object"&&"default"in e?e.default:e}function trimWrappers(e){return e.replace(/\[\[/g,"").replace(/\]\]/g,"").replace(/\{\{/g,"").replace(/\}\}/g,"").trim()}function trimOr(e){var t=e.indexOf("|");return t!==-1?e.substring(0,t):e}function getValue(e,t){if(!e)return null;var r=e.trim().replace(/File:/,"").replace(/\{\{\d+\}\}/g,"").replace(extraPropertyPattern,"").replace(endingPattern,"");if(r==="y"||r==="yes")return!0;if(t=="birthPlace")return e.trim();var n=r.match(linksPattern);return n?n[0].split(linkSeparatorPattern).filter(function(a){return a}):trimOr(trimWrappers(r))}function dataType(e){var t=e.globalPattern,r=e.parsePattern,n=e.parse,a=e.variable,o=e.name;return function(i){var u=i.match(t);if(!u){var f;return f={},defineProperty(f,o,[]),defineProperty(f,"sourceAfter",i),f}var c=u.map(function(s){return n(s.match(r))}),l=u.reduce(function(s,d,h){return c[h]===DO_NOT_REPLACE?s:s.replace(d,"$"+a+"_"+h)},i);return{data:defineProperty({},o,c),sourceAfter:l}}}function byDataHandler(e,t){var r=e.source,n=e.context,a=t(r),o=a.data,i=a.sourceAfter;return{context:Object.assign({},n,o),source:i}}function extractData(e){return dataTypes$1.map(function(t){return t.handler}).reduce(byDataHandler,{context:{},source:e})}function findPropertyList(e){var t=e.match(keyValueGlobalPattern);return t?t.map(function(r){var n=keyValuePattern.exec(r);if(!n)return null;var a=slicedToArray(n,3),o=a[1],i=a[2],u=camelCase(o.trim());return{key:u,value:getValue(i,u)}}).filter(function(r){return r}):[]}function fillVariable(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.simplifyDataValues;if(typeof e!="string")return console.log("Warning: Something went wrong. Could not fill variables in: ("+(e===void 0?"undefined":_typeof(e))+") "+JSON.stringify(e)),{};var a=dataTypes$1.find(function(l){return e.match(l.pattern)});if(a){var o=a.pattern.exec(e),i=slicedToArray(o,2),u=i[0],f=i[1],c=t[a.name][parseInt(f,10)];return n||typeof c!="string"?c:e.replace(u,c)}return e}function fillVariables(e,t,r){if(e===void 0||e instanceof Date||typeof e=="number")return e;if(Array.isArray(e))return e.map(function(a){return fillVariables(a,t,r)});if((e===void 0?"undefined":_typeof(e))==="object")return Object.keys(e).reduce(function(a,o){return Object.assign(a,defineProperty({},o,fillVariables(e[o],t,r)))},{});var n=fillVariable(e,t,r);return n===e?e:fillVariables(n,t,r)}function handleSmallData(e,t,r){var n=r.simplifyDataValues;if(typeof e=="string"&&e.match(smallDataType.pattern)){var a=e.replace(smallDataType.pattern,"").replace(/,/,"").trim(),o=smallDataType.pattern.exec(e),i=slicedToArray(o,2),u=i[1],f=t[smallDataType.name][parseInt(u,10)],c={primary:getVariableValue(a,t,{simplifyDataValues:n}),secondary:getVariableValue(f,t,{simplifyDataValues:n})};return n?c.primary:c}return null}function getVariableValue(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},n=r.simplifyDataValues,a=handleSmallData(e,t,{simplifyDataValues:n});return a||fillVariables(e,t,{simplifyDataValues:n})}function reduceVariable(e,t,r,n){if(t===null)return null;if(typeof t=="boolean")return t;if(Array.isArray(t))return t.map(function(u){return getVariableValue(u,r,n)});if(e.match(/areaTotal/)||e.match(/population/)){var a=numberParse(t);if(a===!1&&(a=parseFloat(t,10)),!isNaN(a))return a}if(e.match(/date/i)){var o=+new Date(t);if(!isNaN(o))return new Date(t)}var i=getVariableValue(t,r,n);return Array.isArray(i)?i.map(function(u){return getVariableValue(u,r,n)}):i}function byVariableReduction(e,t){return function(r,n){var a=n.key,o=n.value,i=reduceVariable(a,o,e,t);return i===""||i===null?r:Object.assign({},r,defineProperty({},a,i))}}function extractProperties(e){var t=e.source,r=e.context,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=n.simplifyDataValues,o=a===void 0||a;return findPropertyList(t).reduce(byVariableReduction(r,{simplifyDataValues:o}),{})}function transformProperties(e){return Object.keys(e).reduce(function(t,r){var n=e[r],a=r.match(blankNamePattern);if(a){var o=a[1]||"",i=e["blank"+o+"NameSec2"],u=e["blank"+o+"InfoSec2"];return typeof i!="string"?t:Object.assign(t,defineProperty({},camelCase(i),u))}return r.match(blankInfoPattern)?t:Object.assign(t,defineProperty({},r,n))},{})}function findOuterIndex(e){for(var t=[],r=0;r<e.length-1;r++){var n=e.substr(r,2);if(n!=="{{"){if(n==="}}"){if(t.pop(),t.length===0)return r+2;r++}}else t.push(r),r++}}function parse(e){var t=e.match(infoBoxStartPattern);if(!t)return{data:e,sourceLeft:null};var r=t.index,n=e.substring(r),a=findOuterIndex(n);if(!a)return{data:e,sourceLeft:null};var o=n.substring(0,a),i=e.substring(a);return{data:o,sourceLeft:i.match(infoBoxStartPattern)?i:null}}function extractInfoboxes(e){for(var t=parse(e),r=[t.data];t.sourceLeft;)t=parse(t.sourceLeft),r.push(t.data);return r}function cleanSource(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=t.removeSmall,n=r!==void 0&&r,a=t.removeReferences;return(a===void 0||a)&&(e=e.replace(/<ref(\s\w+=[^>]+)?>.*<\/ref>/g,"").replace(/<ref(\s\w+=[^>]+)?\s?\/>/g,"")),n&&(e=e.replace(/<small>.*<\/small>/g,"")),e.replace(/'''?/g,"").replace(/\|display=inline/g,"").replace(/<br\s?\/?>/g,",").replace(/&minus;/g,"-").replace(/<sup>/g,"^").replace(/\{\{sfn\|([^\}\}]+)\}\}/g,"").replace(/\{\{efn\|([^\}\}]+)\}\}/g,"").replace(//g,"-").replace(/<\/sup>/g,"").replace(/\{\{\s*nowrap\s*\|([^\n\}]+)\}\}/gi,"$1").replace(/<!--([\s\S]*?)-->/g,"").replace(/&nbsp;/g," ").replace("|''See list''","")}function transformRowSpan(e){return e.map(transformCells).reduce(function(t,r,n){for(var a=n===0?0:1,o=0;o<r.length;o++)t[o+a]||(t[o+a]={}),r[o]&&(t[o+a][r[o]]=1);return t},[]).map(function(t){return Object.keys(t).join(",")}).join(" || ")}function clean(e){return e.substring(2,e.length-2).replace(linkPattern$1,function(t,r){return r.split("|")[0]}).replace(/'''?/g,"")}function parseRow(e){var t=e[0].match(/BS(\d)/),r=e[0].substring(2),n=1,a=[],o=1;for(t&&(n=t[1],r=e[0].substring(3));o<=n;o++)a.push(e[o]);return{type:r,margin:e[o++],text1:e[o++],text2:e[o++],comment:e[o++],icons:a}}function getMatches(e,t){for(var r=void 0,n=[];(r=t.exec(e))!==null;)n.push({value:r[1]&&r[1].trim(),start:r.index,end:r.index+r[0].length});return n}function parseTableData(e){var t=e.match(rowPattern$1);return t?t.map(function(r){var n=r.match(rowPatternSingle);return slicedToArray(n,2)[1].trim().split("|").slice(1)}):[]}function getTables(e){var t=getMatches(e,tableStartPattern$1),r=getMatches(e,tableEndPattern$1);return t.map(function(n,a){var o=r[a];if(!o)throw new Error("[Table Parsing] Failed to pair table");return{rows:parseTableData(e.substring(n.end,o.start).trim().replace(/'''/g,"")),start:n.start,end:o.end}})}function last(e){return e.length?e[e.length-1]:void 0}function parseInfobox(e,t){var r=extractInfoboxes(e).map(function(a){return transformProperties(extractProperties(extractData(cleanSource(a,t)),t))});if(!r.length)return{};var n={general:r.shift()};return r.forEach(function(a){var o=a.type;o?n[camelCase(o)]=a:Object.assign(n,{general:Object.assign({},n.general,a)})}),n.tables=parseTables(e),n.bsTables=parseBsTables(e),n.lists=parseLists(e),n}var camelCase=_interopDefault(camelcase),_typeof=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},defineProperty=function(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e},slicedToArray=function(){function e(t,r){var n=[],a=!0,o=!1,i=void 0;try{for(var u,f=t[Symbol.iterator]();!(a=(u=f.next()).done)&&(n.push(u.value),!r||n.length!==r);a=!0);}catch(c){o=!0,i=c}finally{try{!a&&f.return&&f.return()}finally{if(o)throw i}}return n}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),toConsumableArray=function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)},smallGlobalPattern=/\{\{small\|([^\}\}]+)\}\}/g,smallPattern=/small\|([^\}\}]+)\}\}/,small={globalPattern:smallGlobalPattern,parsePattern:smallPattern,parse:function(e){return slicedToArray(e,2)[1]},variable:"SMALL",name:"smalls"},flagGlobalPattern=/\{\{flag\|([^\}\}]+)\}\}/g,flagPattern=/flag\|([^\}\}]+)\}\}/,flag={globalPattern:flagGlobalPattern,parsePattern:flagPattern,parse:function(e){return slicedToArray(e,2)[1]},variable:"FLAG",name:"flags"},coordsGlobalPattern=/\{\{coord\|([^\}\}]+)\}\}/g,coordsPattern=/coord\|([^\}\}]+)\}\}/,coords={globalPattern:coordsGlobalPattern,parsePattern:coordsPattern,parse:function(e){return slicedToArray(e,2)[1]},variable:"COORD",name:"coords"},globalPattern=/\[\[([^\]\|]+)\|?([^\]]+)?\]\]/g,pattern=/\[\[([^\]\|]+)\|?([^\]]+)?\]\]/,instances={globalPattern,parsePattern:pattern,parse:function(e){var t=slicedToArray(e,3),r=t[1],n=t[2];return r||n},variable:"INSTANCE",name:"instances"},extraPropertyPattern=/\n?\s?\|\s?\w+$/,endingPattern=/\n\}\}$/,linksPattern=/((\$\w+_\d+)\s*,?\s*){2,}/g,linkSeparatorPattern=/[,\s?]/g,listItemPrefixPattern=/^\|\s?/,unbulletedListGlobalPattern=/\{\{(?:unbulleted list|ubl|ubt|ublist|unbullet)\s?\|([^\}\}]+)\}\}/gi,unbulletedListItemPattern=/\|\s*([^|}]+)/g,unbulletedLists={globalPattern:unbulletedListGlobalPattern,parsePattern:unbulletedListItemPattern,parse:function(e){return e?e.map(function(t){return t.replace(listItemPrefixPattern,"").trim()}).filter(function(t){return t&&t.length}):[]},variable:"UNBULLETED_LIST",name:"unbulletedLists"},listItemPrefixPattern$1=/^\*\s*/,plainListGlobalPattern=/\n(\*\s*[^*|]+)+/g,plainListItemPattern=/\*\s*([^*|]+)/g,unmarkedLists={globalPattern:plainListGlobalPattern,parsePattern:plainListItemPattern,parse:function(e){return e?e.map(function(t){return t.replace(listItemPrefixPattern$1,"").trim()}).filter(function(t){return t&&t.length}):[]},variable:"UNMARKED_LIST",name:"unmarkedLists"},listItemPrefixPattern$2=/^\*\s?/,plainListGlobalPattern$1=/\{\{f?p?P?l?a?i?n?t?\s?list\s?\|([^\}\}]+)\}\}/g,plainListItemPattern$1=/\*\s*([^*}]+)/g,plainLists={globalPattern:plainListGlobalPattern$1,parsePattern:plainListItemPattern$1,parse:function(e){return e?e.map(function(t){return t.replace(listItemPrefixPattern$2,"").trim()}).filter(function(t){return t&&t.length}):[]},variable:"PLAIN_LIST",name:"plainLists"},marriageGlobalPattern=/\{\{Marriage\|([^\}\}]+)\}\}/gi,marriagePattern=/Marriage\|([^|]+)\|(.*)\}\}/i,marriages={globalPattern:marriageGlobalPattern,parsePattern:marriagePattern,parse:function(e){var t=slicedToArray(e,3);return{who:t[1],married:t[2]}},variable:"MARRIAGE",name:"marriages"},nbayGlobalPattern=/\{\{nbay\|([^\}\}]+)\}\}/gi,nbayPattern=/nbay\|([^|]+)\|(.*)\}\}/i,nbay={globalPattern:nbayGlobalPattern,parsePattern:nbayPattern,parse:function(e){var t=slicedToArray(e,3),r=t[1];return t[2],r},variable:"nbay",name:"nbay"},otherGlobalPattern=/\{\{([^|\n]+)\|([^|\n]+)\|?([^\}\n]+)?\}\}/g,otherPattern=/\{\{([^|\n]+)\|([^|\n]+)\|?([^\}\n]+)?\}\}/,other={globalPattern:otherGlobalPattern,parsePattern:otherPattern,parse:function(e){var t=slicedToArray(e,4),r=t[1];return t[2],t[3],r},variable:"OTHER",name:"others"},hlistGlobalPattern=/\{\{hlist\|([^\}\}]+)\}\}/gi,hlistPattern=/hlist\|(.*)\n?\}\}/i,hlist={globalPattern:hlistGlobalPattern,parsePattern:hlistPattern,parse:function(e){return slicedToArray(e,2)[1].split("|")},variable:"HLIST",name:"hlists"},birthDateGlobalPattern=/\{\{birth\sdate([^\}\}]+)\}\}/gi,birthDatePattern=/(\d+)\|(\d+)\|(\d+)/,millisInYear=31536e6,birthDates={globalPattern:birthDateGlobalPattern,parsePattern:birthDatePattern,parse:function(e){var t=slicedToArray(e,4),r=t[1],n=t[2],a=t[3],o=new Date(r,n-1,a);return{date:o,age:Math.floor((Date.now()-+o)/millisInYear)}},variable:"BIRTH_DATE",name:"birthDates"},DO_NOT_REPLACE=Symbol("DO NOT REPLACE"),labeledDateGlobalPattern=/\{\{([^\n\}\}]+)\}\}/g,labeledDatePattern=/(.*)/,labeledDates={globalPattern:labeledDateGlobalPattern,parsePattern:labeledDatePattern,parse:function(e){var t=e[0].indexOf("|");if(t>-1){var r=e[0].substring(t+1).slice(0,-2),n=new Date(r+" GMT");if(!isNaN(n.getTime()))return{date:n};if(n=new Date(r.split("|").join("-")+" GMT"),!isNaN(n.getTime()))return{date:n}}return DO_NOT_REPLACE},variable:"LABELED_DATE",name:"labeledDates"},deathDateGlobalPattern=/\{\{death\sdate\sand\sage([^\}\}]+)\}\}/gi,deathDatePattern=/(\d+)\|(\d+)\|(\d+)\|(\d+)\|?(\d+)?\|?(\d+)?/,millisInYear$1=31536e6,deathDates={globalPattern:deathDateGlobalPattern,parsePattern:deathDatePattern,parse:function(e){var t=slicedToArray(e,7),r=t[1],n=t[2],a=t[3],o=t[4],i=t[5],u=i===void 0?0:i,f=t[6],c=f===void 0?0:f,l=new Date(r,n-1,a),s=new Date(o,u-1,c);return{date:l,age:Math.floor((Number(l)-Number(s))/millisInYear$1)}},variable:"DEATH_DATE",name:"deathDates"},URLGlobalPattern=/\{\{URL\|([^\}\}]+)\}\}/g,URLPattern=/URL\|([^\}\}]+)\}\}/,url={globalPattern:URLGlobalPattern,parsePattern:URLPattern,parse:function(e){return slicedToArray(e,2)[1]},variable:"URL",name:"urls"},websiteGlobalPattern=/\[(https?):\/\/((?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6})\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)\s+([\w\s]+)\]/g,websitePattern=/\[(https?):\/\/((?:www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6})\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)\s+([\w\s]+)\]/,website={globalPattern:websiteGlobalPattern,parsePattern:websitePattern,parse:function(e){var t=slicedToArray(e,5),r=t[1],n=t[2],a=t[3];return{protocol:r,hostname:n,path:a,title:t[4],url:r+"://"+n+a}},variable:"WEBSITE",name:"websites"},globalPattern$1=/\{\{Extra[^}}]+\}\}/gi,parsePattern=/\|\s?(\w+)\s+=\s+(.+)/g,propPattern=/\|\s?(\w+)\s+=\s+(.+)/,extra={globalPattern:globalPattern$1,parsePattern,parse:function(e){return e.reduce(function(t,r){var n=r.match(propPattern),a=slicedToArray(n,3),o=a[1],i=a[2];return t[o]=i,t},{})},variable:"EXTRA",name:"extra"},convertGlobalPattern=/\{\{convert\|([\d\.]+)\|(\w+)/g,convertPattern=/\{\{convert\|([\d\.]+)\|(\w+)/,convert={globalPattern:convertGlobalPattern,parsePattern:convertPattern,parse:function(e){var t=slicedToArray(e,3);return t[1]+" "+t[2]},variable:"CONVERT",name:"converts"},filmDatesPattern=/\{\{film\sdate([^\}\}]+)\}\}/gi,filmDatePatternGlobal=/(\d+)\|?(\d+)\|?(\d+)\|?([^\|\}]*)\|?(ref\d+=([^\|\}]*))?/g,filmDatePattern=/(\d+)\|?(\d+)\|?(\d+)\|?([^\|\}]*)\|?(ref\d+=([^\|\}]*))?/,filmDates={globalPattern:filmDatesPattern,parsePattern:filmDatePatternGlobal,parse:function(e){return e.map(function(t){var r=t.match(filmDatePattern),n=slicedToArray(r,7),a=(n[0],n[1]),o=n[2],i=n[3],u=n[4],f=(n[5],n[6]);return{date:new Date(a,o&&o-1,i),location:u,ref:f}})},variable:"FILM_DATES",name:"filmDates"},otherGlobalPattern$1=/<ref(\s\w+=[^>]+)?>(.*)<\/ref>/g,otherPattern$1=/<ref(\s\w+=[^>]+)?>(.*)<\/ref>/,attributeGlobalPattern=/(\w+)=(["\w]+)/g,attributePattern=/(\w+)=(["\w]+)/,ref1={globalPattern:otherGlobalPattern$1,parsePattern:otherPattern$1,parse:function(e){var t=slicedToArray(e,3),r=(t[0],t[1]),n=t[2];return{attributes:((r||"").match(attributeGlobalPattern)||[]).reduce(function(a,o){if(o){var i=o.match(attributePattern),u=slicedToArray(i,3),f=(u[0],u[1]),c=u[2];a[f]=c.replace(/"/g,"")}return a},{}),contents:n}},variable:"REF",name:"refs"},otherGlobalPattern$2=/<ref(\s\w+=[^>]+)?\/>/g,otherPattern$2=/<ref(\s\w+=[^>]+)?\/>/,attributeGlobalPattern$1=/(\w+)=(["\w]+)/g,attributePattern$1=/(\w+)=(["\w]+)/,ref2={globalPattern:otherGlobalPattern$2,parsePattern:otherPattern$2,parse:function(e){return{attributes:e[1].match(attributeGlobalPattern$1).reduce(function(t,r){var n=r.match(attributePattern$1),a=slicedToArray(n,3),o=(a[0],a[1]),i=a[2];return t[o]=i.replace(/"/g,""),t},{})}},variable:"REF",name:"refs"},globalPattern$2=/\{\{formatnum:\d+\}\}/gi,parsePattern$1=/\{\{formatnum:(\d+)\}\}/,formatNum={globalPattern:globalPattern$2,parsePattern:parsePattern$1,parse:function(e){var t=slicedToArray(e,2),r=t[1];return parseFloat(r)},variable:"FORMAT_NUM",name:"formatNum"},dataTypes=[instances,ref1,ref2,small,formatNum,flag,coords,marriages,birthDates,labeledDates,deathDates,unbulletedLists,website,hlist,url,convert,nbay,filmDates,other,extra,plainLists,unmarkedLists],dataTypes$1=dataTypes.map(function(e){return{handler:dataType(e),name:e.name,pattern:new RegExp("\\$"+e.variable+"_(\\d+)")}}),keyValueGlobalPattern=/\|\s*([-'\u0400-\u04FF\w\s]+)\s*=\s*([^|]+)?/g,keyValuePattern=/\|\s*([-'\u0400-\u04FF\w\s]+)\s*=\s*([^|]+)?/,numberParse=function(e){return typeof e=="string"&&(e=e.trim().replace(/ /g,""),e.match(/,/)&&e.match(/\./)?e.indexOf(",")<e.indexOf(".")?parseEnglish(e):parseSpanish(e):e.match(/,/)&&!e.match(/\./)?e.match(/,/g).length>1||e.match(/,[0-9]{3}($|^[0-9])/)?parseEnglish(e):parseSpanish(e):!e.match(/,/)&&e.match(/\./)?e.match(/\./g).length>1||e.match(/\.[0-9]{3}($|^[0-9])/)?parseSpanish(e):parseEnglish(e):(+e).toString()===e&&+e)},parseEnglish=function(e){return+e.replace(/,/g,"")},parseSpanish=function(e){return+e.replace(/\./g,"").replace(/,/g,".")},smallDataType=dataTypes$1.find(function(e){return e.name==="smalls"}),blankNamePattern=/blank(\d+)?NameSec2/,blankInfoPattern=/blank(\d+)?InfoSec2/,infoBoxStartPattern=/{{\w*box/,tableStartPattern=/{\|(.*)\n?/,tableEndPattern=/\n\|}/,headersPattern=/!\s?(.*)/g,rowPattern=/\|-/,cellSeparatorPattern=/(?:\n\|)|(?:\|\|)/,linkPattern=/\[\[([^\]]+)\]\]/g,linkNamePattern=/^.*\|/,inlineHeaderPattern="!!",actionPattern=/{{anchor\|(.*)}}/g,rowSpanCountPattern=/rowspan="(\d+)"/,stripLinks=function(e){return e.replace(linkPattern,function(t,r){return r.replace(linkNamePattern,"").trim()||r})},removeActions=function(e){return e.replace(actionPattern,"")},transformCell=function(e){return stripLinks(removeActions(e||"")).replace(rowSpanCountPattern,"").replace(linkNamePattern,"").trim()},transformCells=function(e){return e.split(cellSeparatorPattern).map(transformCell)},findIndex=function(e,t){var r=e.match(t);return r?r.index:-1},findTableStart=function(e){var t=e.match(tableStartPattern);return t?t.index+t[0].length:-1},findTableEnd=function(e){return findIndex(e,tableEndPattern)},getHeaders=function(e){for(var t=[],r=void 0;r=headersPattern.exec(e);)t.push.apply(t,toConsumableArray(r[1].split(inlineHeaderPattern).map(transformCell)));return t},getRows=function(e){var t=e.split(rowPattern).map(function(h){return h.replace(/^.*\n+?\|/,"").trim()}).filter(function(h){return h}),r=[],n=0,a=0,o=[],i=!0,u=!1,f=void 0;try{for(var c,l=t[Symbol.iterator]();!(i=(c=l.next()).done);i=!0){var s=c.value,d=s.match(rowSpanCountPattern);d&&(n=0,a=parseInt(d[1]),o=[]),n<a?(o.push(s),++n===a&&r.push(transformRowSpan(o))):r.push(s)}}catch(h){u=!0,f=h}finally{try{!i&&l.return&&l.return()}finally{if(u)throw f}}return r},getNextTable=function(e,t,r){var n=e,a=findTableStart(n);if(a===-1)return null;n=n.substring(a);var o=findTableEnd(n);if(o===-1)return null;n=n.substring(0,o);var i=getRows(n);if(!i.length)return null;var u=getHeaders(i[0]);return u.length?{data:i.slice(1).map(transformCells).map(function(f){return u.reduce(function(c,l,s){return c[camelCase(fillVariable(l,t,r))]=fillVariables(f[s],t,r),c},{})}),end:a+o}:null},parseTables=function(e,t){for(var r=cleanSource(e,t),n=extractData(r),a=[],o=n.source,i=null;i=getNextTable(o,n.context,t);){if(!i)return a;a.push(i.data),o=o.substring(i.end)}return a},linkPattern$1=/\[\[([^\]]+)\]\]/g,kmPattern=/{{BSkm\|([\dx]+,[\dx]+)\|([\dx]+,[\dx]+)}}/g,parseBsTables=function(e){var t=e.replace(kmPattern,"$1/$2").match(/{{BS([^}}]+)}}/g);return t?t.map(function(r){return clean(r).split("|")}).map(parseRow).filter(function(r){return r.type[0]!=="-"}):null},headingPattern=/[^=]==\s?([\w\s]+)\s?==/g,subheadingPattern=/===([\w\s]+)===/g,tableStartPattern$1=/{{list.+start.*}}/gi,tableEndPattern$1=/{{list.+end.*}}/gi,rowPattern$1=/{{(.*)}}/g,rowPatternSingle=/{{(.*)}}/,parseLists=function(e){var t=getMatches(e,headingPattern),r=getMatches(e,subheadingPattern),n=getTables(e);return n.forEach(function(a){var o=t.filter(function(u){return u.end<a.start}).map(function(u){return u.value});a.heading=last(o);var i=r.filter(function(u){return u.end<a.start}).map(function(u){return u.value});a.subheading=last(i),delete a.start,delete a.end}),n},bundle_min=parseInfobox;(function(exports){Object.defineProperty(exports,"__esModule",{value:!0}),exports.citation=exports.pdf=exports.mobileHtml=exports.media=exports.related=exports.summary=exports.rawInfo=exports.tables=exports.infobox=exports.langLinks=exports.coordinates=exports.references=exports.links=exports.categories=exports.content=exports.html=exports.intro=exports.images=exports.Page=void 0;const errors_1=errors,request_1=request,utils_1=utils,messages_1=messages,infoboxParser=bundle_min;class Page{constructor(e){this.intro=async t=>{try{if(!this._intro){const r=await exports.intro(this.pageid.toString(),t==null?void 0:t.redirect);this._intro=r}return this._intro}catch(r){throw new errors_1.introError(r)}},this.images=async t=>{try{if(!this._images){const r=await exports.images(this.pageid.toString(),t);this._images=r}return this._images}catch(r){throw new errors_1.imageError(r)}},this.summary=async t=>{try{if(!this._summary){const r=await exports.summary(this.title,t==null?void 0:t.redirect);this._summary=r}return this._summary}catch(r){throw new errors_1.summaryError(r)}},this.html=async t=>{try{if(!this._html){const r=await exports.html(this.pageid.toString(),t==null?void 0:t.redirect);this._html=r}return this._html}catch(r){throw new errors_1.htmlError(r)}},this.content=async t=>{try{if(!this._content){const r=await exports.content(this.pageid.toString(),t==null?void 0:t.redirect);this.parentid=r.ids.parentId,this.revid=r.ids.revId,this._content=r.result}return this._content}catch(r){throw new errors_1.contentError(r)}},this.categories=async t=>{try{if(!this._categories){const r=await exports.categories(this.pageid.toString(),t);this._categories=r}return this._categories}catch(r){throw new errors_1.categoriesError(r)}},this.links=async t=>{try{if(!this._links){const r=await exports.links(this.pageid.toString(),t);this._links=r}return this._links}catch(r){throw new errors_1.linksError(r)}},this.references=async t=>{try{if(!this._references){const r=await exports.references(this.pageid.toString(),t);this._references=r}return this._references}catch(r){throw new errors_1.linksError(r)}},this.coordinates=async t=>{try{if(!this._coordinates){const r=await exports.coordinates(this.pageid.toString(),t==null?void 0:t.redirect);this._coordinates=r}return this._coordinates}catch(r){throw new errors_1.coordinatesError(r)}},this.langLinks=async t=>{try{if(!this._langLinks){const r=await exports.langLinks(this.pageid.toString(),t);this._langLinks=r}return this._langLinks}catch(r){throw new errors_1.linksError(r)}},this.infobox=async t=>{try{if(!this._infobox){const r=await exports.infobox(this.pageid.toString(),t==null?void 0:t.redirect);this._infobox=r}return this._infobox}catch(r){throw new errors_1.infoboxError(r)}},this.tables=async t=>{try{if(!this._tables){const r=await exports.tables(this.pageid.toString(),t==null?void 0:t.redirect);this._tables=r}return this._tables}catch(r){throw new errors_1.infoboxError(r)}},this.related=async t=>{try{if(!this._related){const r=await exports.related(this.title,t==null?void 0:t.redirect);this._related=r}return this._related}catch(r){throw new errors_1.relatedError(r)}},this.media=async t=>{try{if(!this._media){const r=await exports.media(this.title,t==null?void 0:t.redirect);this._media=r}return this._media}catch(r){throw new errors_1.mediaError(r)}},this.mobileHtml=async t=>{try{if(!this._mobileHtml){const r=await exports.mobileHtml(this.title,t==null?void 0:t.redirect);this._mobileHtml=r}return this._mobileHtml}catch(r){throw new errors_1.htmlError(r)}},this.pdf=async t=>{try{return await exports.pdf(this.title,t)}catch(r){throw new errors_1.pdfError(r)}},this.pageid=e.pageid,this.ns=e.ns,this.title=e.title,this.contentmodel=e.contentmodel,this.pagelanguage=e.pagelanguage,this.pagelanguagedir=e.pagelanguagedir,this.touched=e.touched,this.lastrevid=e.lastrevid,this.length=e.length,this.fullurl=e.fullurl,this.editurl=e.editurl,this.canonicalurl=e.canonicalurl}async runMethod(functionName){try{const result=await eval(`this.${functionName}()`);return result}catch(e){throw new errors_1.preloadError(e)}}}exports.Page=Page,exports.images=async(e,t)=>{try{let r={generator:"images",gimlimit:(t==null?void 0:t.limit)||5,prop:"imageinfo",iiprop:"url"};r=utils_1.setPageIdOrTitleParam(r,e);const n=await request_1.default(r,t==null?void 0:t.redirect),a=[],o=Object.keys(n.query.pages);for(const i of o){const u=n.query.pages[i];u.url=u.imageinfo[0].url,a.push(u)}return a}catch(r){throw new errors_1.imageError(r)}},exports.intro=async(e,t=!0)=>{var r;try{let n={prop:"extracts",explaintext:"",exintro:""};n=utils_1.setPageIdOrTitleParam(n,e);const a=await request_1.default(n,t),o=utils_1.setPageId(n,a);return(r=a==null?void 0:a.query)===null||r===void 0?void 0:r.pages[o].extract}catch(n){throw new errors_1.introError(n)}},exports.html=async(e,t=!0)=>{try{let r={prop:"revisions",rvprop:"content",rvlimit:1,rvparse:""};r=utils_1.setPageIdOrTitleParam(r,e);const n=await request_1.default(r,t),a=utils_1.setPageId(r,n);return n.query.pages[a].revisions[0]["*"]}catch(r){throw new errors_1.htmlError(r)}},exports.content=async(e,t=!0)=>{try{let r={prop:"extracts|revisions",explaintext:"",rvprop:"ids"};r=utils_1.setPageIdOrTitleParam(r,e);const n=await request_1.default(r,t),a=utils_1.setPageId(r,n),o=n.query.pages[a].extract,i={revisionId:n.query.pages[a].revisions[0].revid,parentId:n.query.pages[a].revisions[0].parentid};return{result:o,ids:i}}catch(r){throw new errors_1.contentError(r)}},exports.categories=async(e,t)=>{try{let r={prop:"categories",pllimit:t==null?void 0:t.limit};r=utils_1.setPageIdOrTitleParam(r,e);const n=await request_1.default(r,t==null?void 0:t.redirect),a=utils_1.setPageId(r,n);return n.query.pages[a].categories.map(o=>o.title)}catch(r){throw new errors_1.categoriesError(r)}},exports.links=async(e,t)=>{try{let r={prop:"links",plnamespace:0,pllimit:(t==null?void 0:t.limit)||"max"};r=utils_1.setPageIdOrTitleParam(r,e);const n=await request_1.default(r,t==null?void 0:t.redirect),a=utils_1.setPageId(r,n);return n.query.pages[a].links.map(i=>i.title)}catch(r){throw new errors_1.linksError(r)}},exports.references=async(e,t)=>{try{let r={prop:"extlinks",ellimit:(t==null?void 0:t.limit)||"max"};r=utils_1.setPageIdOrTitleParam(r,e);const n=await request_1.default(r,t==null?void 0:t.redirect),a=utils_1.setPageId(r,n);return n.query.pages[a].extlinks.map(i=>i["*"])}catch(r){throw new errors_1.linksError(r)}},exports.coordinates=async(e,t=!0)=>{try{let r={prop:"coordinates"};r=utils_1.setPageIdOrTitleParam(r,e);const n=await request_1.default(r,t),a=utils_1.setPageId(r,n),o=n.query.pages[a].coordinates;return o?o[0]:null}catch(r){throw new errors_1.coordinatesError(r)}},exports.langLinks=async(e,t)=>{try{let r={prop:"langlinks",lllimit:(t==null?void 0:t.limit)||"max",llprop:"url"};r=utils_1.setPageIdOrTitleParam(r,e);const n=await request_1.default(r,t==null?void 0:t.redirect),a=utils_1.setPageId(r,n);return n.query.pages[a].langlinks.map(i=>({lang:i.lang,title:i["*"],url:i.url}))}catch(r){throw new errors_1.linksError(r)}},exports.infobox=async(e,t=!0)=>{try{const r={prop:"revisions",rvprop:"content",rvsection:0},n=await exports.rawInfo(e,r,t);return infoboxParser(n).general}catch(r){throw new errors_1.infoboxError(r)}},exports.tables=async(e,t=!0)=>{try{const r={prop:"revisions",rvprop:"content"},n=await exports.rawInfo(e,r,t);return infoboxParser(n).tables}catch(r){throw new errors_1.infoboxError(r)}},exports.rawInfo=async(e,t,r=!0)=>{var n;try{t=utils_1.setPageIdOrTitleParam(t,e);const a=await request_1.default(t,r);if(!(!((n=a.query)===null||n===void 0)&&n.pages))throw new errors_1.wikiError(messages_1.MSGS.INFOBOX_NOT_EXIST);const o=utils_1.setPageId(t,a),i=a.query.pages[o].revisions[0];return i?i["*"]:""}catch(a){throw new errors_1.infoboxError(a)}},exports.summary=async(e,t=!0)=>{try{const r="page/summary/"+e.replace(" ","_");return await request_1.makeRestRequest(r,t)}catch(r){throw new errors_1.summaryError(r)}},exports.related=async(e,t=!0)=>{try{const r="page/related/"+e.replace(" ","_");return await request_1.makeRestRequest(r,t)}catch(r){throw new errors_1.relatedError(r)}},exports.media=async(e,t=!0)=>{try{const r="page/media-list/"+e.replace(" ","_");return await request_1.makeRestRequest(r,t)}catch(r){throw new errors_1.mediaError(r)}},exports.mobileHtml=async(e,t=!0)=>{try{const r=`page/mobile-html/${e}`;return await request_1.makeRestRequest(r,t)}catch(r){throw new errors_1.htmlError(r)}},exports.pdf=async(e,t)=>{try{let r=`page/pdf/${e}`;return t!=null&&t.format&&(r+=`/${t.format}`),t!=null&&t.type&&(r+=`/${t.type}`),request_1.returnRestUrl(r)}catch(r){throw new errors_1.pdfError(r)}},exports.citation=async(e,t,r)=>{try{let n="data/citation";return n+=t?`/${t}`:"/mediawiki",n+=`/${e}`,r&&(n+=`/${r}`),await request_1.makeRestRequest(n)}catch(n){throw new errors_1.citationError(n)}},exports.default=Page})(page);var resultTypes={};Object.defineProperty(resultTypes,"__esModule",{value:!0});var optionTypes={};Object.defineProperty(optionTypes,"__esModule",{value:!0});(function(e,t){var r=commonjsGlobal&&commonjsGlobal.__createBinding||(Object.create?function(l,s,d,h){h===void 0&&(h=d),Object.defineProperty(l,h,{enumerable:!0,get:function(){return s[d]}})}:function(l,s,d,h){h===void 0&&(h=d),l[h]=s[d]}),n=commonjsGlobal&&commonjsGlobal.__exportStar||function(l,s){for(var d in l)d!=="default"&&!s.hasOwnProperty(d)&&r(s,l,d)};Object.defineProperty(t,"__esModule",{value:!0});const a=request,o=page,i=errors,u=messages,f=utils,c=async(l,s)=>c.page(l,s);c.search=async(l,s)=>{try{const d={list:"search",srprop:"",srlimit:(s==null?void 0:s.limit)||10,srsearch:l};s!=null&&s.suggestion&&(d.srinfo="suggestion");const h=await a.default(d);return{results:h.query.search,suggestion:h.query.searchinfo?h.query.searchinfo.suggestion:null}}catch(d){throw new i.searchError(d)}},c.page=async(l,s)=>{try{s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l));let d={prop:"info|pageprops",inprop:"url",ppprop:"disambiguation"};d=f.setPageIdOrTitleParam(d,l);const h=await a.default(d);let v=h.query.pages;const g=f.setPageId(d,h);if(v=v[g],v.missing=="")throw new i.pageError(`${u.MSGS.PAGE_NOT_EXIST}${l}`);const m=new o.default(v);if(s!=null&&s.preload){s!=null&&s.fields||(s.fields=["summary","images"]);for(const E of s.fields)await m.runMethod(E)}return m}catch(d){throw new i.pageError(d)}},c.intro=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.intro(l,s==null?void 0:s.redirect)}catch(d){throw new i.introError(d)}},c.images=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.images(l,s)}catch(d){throw new i.imageError(d)}},c.summary=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.summary(l,s==null?void 0:s.redirect)}catch(d){throw new i.summaryError(d)}},c.html=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.html(l,s==null?void 0:s.redirect)}catch(d){throw new i.htmlError(d)}},c.content=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),(await o.content(l,s==null?void 0:s.redirect)).result}catch(d){throw new i.contentError(d)}},c.categories=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.categories(l,s)}catch(d){throw new i.categoriesError(d)}},c.related=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.related(l,s==null?void 0:s.redirect)}catch(d){throw new i.relatedError(d)}},c.media=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.media(l,s==null?void 0:s.redirect)}catch(d){throw new i.mediaError(d)}},c.links=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.links(l,s)}catch(d){throw new i.linksError(d)}},c.references=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.references(l,s)}catch(d){throw new i.linksError(d)}},c.coordinates=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.coordinates(l,s==null?void 0:s.redirect)}catch(d){throw new i.coordinatesError(d)}},c.langLinks=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.langLinks(l,s)}catch(d){throw new i.linksError(d)}},c.infobox=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.infobox(l,s==null?void 0:s.redirect)}catch(d){throw new i.infoboxError(d)}},c.tables=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.tables(l,s==null?void 0:s.redirect)}catch(d){throw new i.infoboxError(d)}},c.languages=async()=>{try{const l={meta:"siteinfo",siprop:"languages"},s=await a.default(l),d=[];for(const h of s.query.languages)d.push({[h.code]:h["*"]});return d}catch(l){throw new i.wikiError(l)}},c.setLang=l=>a.setAPIUrl(l),c.geoSearch=async(l,s,d)=>{try{const h={list:"geosearch",gsradius:(d==null?void 0:d.radius)||1e3,gscoord:`${l}|${s}`,gslimit:(d==null?void 0:d.limit)||10,gsprop:"type"};return(await a.default(h)).query.geosearch}catch(h){throw new i.geoSearchError(h)}},c.suggest=async l=>{var s,d,h,v;try{const g={list:"search",srinfo:"suggestion",srprop:"",srsearch:l},m=await a.default(g);return!((d=(s=m.query)===null||s===void 0?void 0:s.searchinfo)===null||d===void 0)&&d.suggestion?(v=(h=m.query)===null||h===void 0?void 0:h.searchinfo)===null||v===void 0?void 0:v.suggestion:null}catch(g){throw new i.searchError(g)}},c.onThisDay=async(l={})=>{try{const s=l.type||"all",d=(l.month||f.getCurrentMonth()).toString().padStart(2,"0"),h=(l.day||f.getCurrentDay()).toString().padStart(2,"0"),v=`feed/onthisday/${s}/${d}/${h}`;return await a.makeRestRequest(v,!0)}catch(s){throw new i.eventsError(s)}},c.featuredContent=async(l={})=>{try{const s=(l.year||f.getCurrentYear()).toString(),d=(l.month||f.getCurrentMonth()).toString().padStart(2,"0"),h=(l.day||f.getCurrentDay()).toString().padStart(2,"0"),v=`feed/featured/${s}/${d}/${h}`;return await a.makeRestRequest(v,!0)}catch(s){throw new i.fcError(s)}},c.random=async l=>{try{l||(l="summary");const s=`page/random/${l}`;return await a.makeRestRequest(s)}catch(s){throw new i.wikiError(s)}},c.mobileHtml=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.mobileHtml(l,s==null?void 0:s.redirect)}catch(d){throw new i.htmlError(d)}},c.pdf=async(l,s)=>{try{return s!=null&&s.autoSuggest&&(l=await f.setTitleForPage(l)),await o.pdf(l,s)}catch(d){throw new i.pdfError(d)}},c.citation=async(l,s,d)=>{try{return await o.citation(l,s,d)}catch(h){throw new i.citationError(h)}},t.default=c,e.exports=c,e.exports.default=c,n(errors,t),n(resultTypes,t),n(optionTypes,t),n(page,t)})(dist,dist.exports);let isMobile=!1;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&(isMobile=!0);function __minimizeUrl(e){return e.replaceAll(/\n\s*/g,"")}let restApiLang="en";function RestApiBase(){return`https://${restApiLang}.wikipedia.org/api/rest_v1`}const getUrlSuggest=e=>__minimizeUrl(`
  https://${appState.lang}.wikipedia.org/w/api.php
  ?action=opensearch
  &format=json
  &formatversion=2
  &search=${e}
  &namespace=0
  &limit=10
  &origin=*`);async function suggestCustom(e){const t=getUrlSuggest(e);console.log("api endpoint:",t),console.log("encoded url:",encodeURI(e));const r=await(await fetch(t)).json();console.log("fetchSearch:",r);const[,n,,a]=r,o=[];for(let i=0;i<n.length;i++){const u=a[i].split("/");o.push({title:n[i],normalized:u[u.length-1]})}return o}async function getSummary(e){const t=RestApiBase()+"/page/summary/"+e;return await(await fetch(t)).json()}async function getResponse(e){const t=RestApiBase()+"/page/related/"+e;return(await(await fetch(t)).json()).pages}function getItem(e){const{description:t,pageid:r,extract_html:n,originalimage:a,thumbnail:o,content_urls:i}=e,u=isMobile?i.mobile.page:i.desktop.page,f={description:t,pageid:r,extract_html:n,originalimage:a,thumbnail:o,page_url:u};return{id:e.titles.normalized,data:f}}function setLang(e){restApiLang=e}const apiClient={suggestCustom,getSummary,getResponse,getItem,setLang},{qs,appState,performSearch,watchState}=useState(apiClient,{lang:""});var Suggestions_svelte_svelte_type_style_lang="";function get_each_context(e,t,r){const n=e.slice();return n[4]=t[r],n[6]=r,n}function create_if_block$1(e){let t,r=e[0],n=[];for(let a=0;a<r.length;a+=1)n[a]=create_each_block(get_each_context(e,r,a));return{c(){t=element("ul");for(let a=0;a<n.length;a+=1)n[a].c();attr(t,"class","suggestions svelte-ltzc10")},m(a,o){insert(a,t,o);for(let i=0;i<n.length;i+=1)n[i].m(t,null)},p(a,o){if(o&7){r=a[0];let i;for(i=0;i<r.length;i+=1){const u=get_each_context(a,r,i);n[i]?n[i].p(u,o):(n[i]=create_each_block(u),n[i].c(),n[i].m(t,null))}for(;i<n.length;i+=1)n[i].d(1);n.length=r.length}},d(a){a&&detach(t),destroy_each(n,a)}}}function create_each_block(e){let t,r=e[4].title+"",n,a,o;function i(){return e[3](e[6])}return{c(){t=element("li"),n=text(r),attr(t,"class","svelte-ltzc10"),toggle_class(t,"selected",e[1]===e[6])},m(u,f){insert(u,t,f),append(t,n),a||(o=listen(t,"click",i),a=!0)},p(u,f){e=u,f&1&&r!==(r=e[4].title+"")&&set_data(n,r),f&2&&toggle_class(t,"selected",e[1]===e[6])},d(u){u&&detach(t),a=!1,o()}}}function create_fragment$5(e){let t,r=e[0].length&&create_if_block$1(e);return{c(){r&&r.c(),t=empty()},m(n,a){r&&r.m(n,a),insert(n,t,a)},p(n,[a]){n[0].length?r?r.p(n,a):(r=create_if_block$1(n),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:noop$4,o:noop$4,d(n){r&&r.d(n),n&&detach(t)}}}function instance$4(e,t,r){let{suggestions:n=[]}=t,{selected:a}=t;const o=createEventDispatcher(),i=u=>o("select",u);return e.$$set=u=>{"suggestions"in u&&r(0,n=u.suggestions),"selected"in u&&r(1,a=u.selected)},[n,a,o,i]}class Suggestions extends SvelteComponent{constructor(t){super(),init(this,t,instance$4,create_fragment$5,safe_not_equal,{suggestions:0,selected:1})}}function create_fragment$4(e){let t;return{c(){t=element("span"),t.innerHTML='<svg width="9" height="6" viewBox="0 0 9 6" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M1.32464 0.838934C1.14535 0.65964 0.854654 0.65964 0.67536 0.838934C0.496066 1.01823 0.496066 1.30892 0.67536 1.48821L1.32464 0.838934ZM4.67288 4.83646L4.34824 5.1611C4.52754 5.34039 4.81823 5.34039 4.99752 5.1611L4.67288 4.83646ZM8.67041 1.48821C8.8497 1.30892 8.8497 1.01823 8.67041 0.838934C8.49111 0.65964 8.20042 0.65964 8.02113 0.838934L8.67041 1.48821ZM0.67536 1.48821L4.34824 5.1611L4.99752 4.51182L1.32464 0.838934L0.67536 1.48821ZM4.99752 5.1611L8.67041 1.48821L8.02113 0.838934L4.34824 4.51182L4.99752 5.1611Z" fill="currentColor"></path></svg>',attr(t,"class","icon")},m(r,n){insert(r,t,n)},p:noop$4,i:noop$4,o:noop$4,d(r){r&&detach(t)}}}class IconArrow extends SvelteComponent{constructor(t){super(),init(this,t,null,create_fragment$4,safe_not_equal,{})}}var LanguageSelect_svelte_svelte_type_style_lang="";function create_fragment$3(e){let t,r,n,a,o,i,u,f,c,l,s,d,h,v,g,m,E,S,_,x,y,k,V,q,L,T,N,G,b,$,j,W,U,Z,I,M,P,F,H,O,K,te,ne,ae,Q,re,se,ue,ce,X,ge,we,Pe,be,xe,Ee,oe,le,me,ve,ye,ke,_e,fe,de,pe,Ce,Ae,he,Ie,Ne,Te,Le,Ze,De,qe,ze,Ue,Re,Be,Oe,We;return Re=new IconArrow({}),{c(){t=element("div"),r=element("select"),n=element("option"),n.textContent="Afrikaans",a=element("option"),a.textContent="Polski",o=element("option"),o.textContent="\u0627\u0644\u0639\u0631\u0628\u064A\u0629",i=element("option"),i.textContent="Asturianu",u=element("option"),u.textContent="Az\u0259rbaycanca",f=element("option"),f.textContent="\u0411\u044A\u043B\u0433\u0430\u0440\u0441\u043A\u0438",c=element("option"),c.textContent="B\xE2n-l\xE2m-g\xFA / H\u014D-l\xF3-o\u0113",l=element("option"),l.textContent="\u09AC\u09BE\u0982\u09B2\u09BE",s=element("option"),s.textContent="\u0411\u0435\u043B\u0430\u0440\u0443\u0441\u043A\u0430\u044F",d=element("option"),d.textContent="Catal\xE0",h=element("option"),h.textContent="\u010Ce\u0161tina",v=element("option"),v.textContent="Cymraeg",g=element("option"),g.textContent="Dansk",m=element("option"),m.textContent="Deutsch",E=element("option"),E.textContent="Eesti",S=element("option"),S.textContent="\u0395\u03BB\u03BB\u03B7\u03BD\u03B9\u03BA\u03AC",_=element("option"),_.textContent="English",x=element("option"),x.textContent="Espa\xF1ol",y=element("option"),y.textContent="Esperanto",k=element("option"),k.textContent="Euskara",V=element("option"),V.textContent="\u0641\u0627\u0631\u0633\u06CC",q=element("option"),q.textContent="Fran\xE7ais",L=element("option"),L.textContent="Galego",T=element("option"),T.textContent="\uD55C\uAD6D\uC5B4",N=element("option"),N.textContent="\u0540\u0561\u0575\u0565\u0580\u0565\u0576",G=element("option"),G.textContent="\u0939\u093F\u0928\u094D\u0926\u0940",b=element("option"),b.textContent="Hrvatski",$=element("option"),$.textContent="Bahasa Indonesia",j=element("option"),j.textContent="Italiano",W=element("option"),W.textContent="\u05E2\u05D1\u05E8\u05D9\u05EA",U=element("option"),U.textContent="\u10E5\u10D0\u10E0\u10D7\u10E3\u10DA\u10D8",Z=element("option"),Z.textContent="Latina",I=element("option"),I.textContent="Latvie\u0161u",M=element("option"),M.textContent="Lietuvi\u0173",P=element("option"),P.textContent="Magyar",F=element("option"),F.textContent="\u041C\u0430\u043A\u0435\u0434\u043E\u043D\u0441\u043A\u0438",H=element("option"),H.textContent="\u0645\u0635\u0631\u0649",O=element("option"),O.textContent="Bahasa Melayu",K=element("option"),K.textContent="Bahaso Minangkabau",te=element("option"),te.textContent="\u1019\u103C\u1014\u103A\u1019\u102C\u1018\u102C\u101E\u102C",ne=element("option"),ne.textContent="Nederlands",ae=element("option"),ae.textContent="\u65E5\u672C\u8A9E",Q=element("option"),Q.textContent="Norsk (bokm\xE5l)",re=element("option"),re.textContent="Norsk (nynorsk)",se=element("option"),se.textContent="\u041D\u043E\u0445\u0447\u0438\u0439\u043D",ue=element("option"),ue.textContent="O\u02BBzbekcha / \u040E\u0437\u0431\u0435\u043A\u0447\u0430",ce=element("option"),ce.textContent="Portugu\xEAs",X=element("option"),X.textContent="\u049A\u0430\u0437\u0430\u049B\u0448\u0430 / Qazaq\u015Fa / \u0642\u0627\u0632\u0627\u0642\u0634\u0627",ge=element("option"),ge.textContent="Rom\xE2n\u0103",we=element("option"),we.textContent="\u0420\u0443\u0441\u0441\u043A\u0438\u0439",Pe=element("option"),Pe.textContent="Simple English",be=element("option"),be.textContent="Sinugboanong Binisaya",xe=element("option"),xe.textContent="Sloven\u010Dina",Ee=element("option"),Ee.textContent="Sloven\u0161\u010Dina",oe=element("option"),oe.textContent="\u0421\u0440\u043F\u0441\u043A\u0438 / Srpski",le=element("option"),le.textContent="Srpskohrvatski / \u0421\u0440\u043F\u0441\u043A\u043E\u0445\u0440\u0432\u0430\u0442\u0441\u043A\u0438",me=element("option"),me.textContent="Suomi",ve=element("option"),ve.textContent="Svenska",ye=element("option"),ye.textContent="\u0BA4\u0BAE\u0BBF\u0BB4\u0BCD",ke=element("option"),ke.textContent="\u0422\u0430\u0442\u0430\u0440\u0447\u0430 / Tatar\xE7a",_e=element("option"),_e.textContent="\u0E20\u0E32\u0E29\u0E32\u0E44\u0E17\u0E22",fe=element("option"),fe.textContent="\u0422\u043E\u04B7\u0438\u043A\u04E3",de=element("option"),de.textContent="\u062A\u06C6\u0631\u06A9\u062C\u0647",pe=element("option"),pe.textContent="T\xFCrk\xE7e",Ce=element("option"),Ce.textContent="\u0423\u043A\u0440\u0430\u0457\u043D\u0441\u044C\u043A\u0430",Ae=element("option"),Ae.textContent="\u0627\u0631\u062F\u0648",he=element("option"),he.textContent="Ti\u1EBFng Vi\u1EC7t",Ie=element("option"),Ie.textContent="Volap\xFCk",Ne=element("option"),Ne.textContent="Winaray",Te=element("option"),Te.textContent="\u7CB5\u8A9E",Le=element("option"),Le.textContent="\u4E2D\u6587",Ze=space(),De=element("div"),qe=element("label"),ze=text(e[0]),Ue=space(),create_component(Re.$$.fragment),n.__value="af",n.value=n.__value,attr(n,"lang","af"),attr(n,"class","svelte-giybgk"),a.__value="pl",a.value=a.__value,attr(a,"lang","pl"),attr(a,"class","svelte-giybgk"),o.__value="ar",o.value=o.__value,attr(o,"lang","ar"),attr(o,"class","svelte-giybgk"),i.__value="ast",i.value=i.__value,attr(i,"lang","ast"),attr(i,"class","svelte-giybgk"),u.__value="az",u.value=u.__value,attr(u,"lang","az"),attr(u,"class","svelte-giybgk"),f.__value="bg",f.value=f.__value,attr(f,"lang","bg"),attr(f,"class","svelte-giybgk"),c.__value="nan",c.value=c.__value,attr(c,"lang","nan"),attr(c,"class","svelte-giybgk"),l.__value="bn",l.value=l.__value,attr(l,"lang","bn"),attr(l,"class","svelte-giybgk"),s.__value="be",s.value=s.__value,attr(s,"lang","be"),attr(s,"class","svelte-giybgk"),d.__value="ca",d.value=d.__value,attr(d,"lang","ca"),attr(d,"class","svelte-giybgk"),h.__value="cs",h.value=h.__value,attr(h,"lang","cs"),attr(h,"class","svelte-giybgk"),v.__value="cy",v.value=v.__value,attr(v,"lang","cy"),attr(v,"class","svelte-giybgk"),g.__value="da",g.value=g.__value,attr(g,"lang","da"),attr(g,"class","svelte-giybgk"),m.__value="de",m.value=m.__value,attr(m,"lang","de"),attr(m,"class","svelte-giybgk"),E.__value="et",E.value=E.__value,attr(E,"lang","et"),attr(E,"class","svelte-giybgk"),S.__value="el",S.value=S.__value,attr(S,"lang","el"),attr(S,"class","svelte-giybgk"),_.__value="en",_.value=_.__value,attr(_,"lang","en"),_.selected=!0,attr(_,"class","svelte-giybgk"),x.__value="es",x.value=x.__value,attr(x,"lang","es"),attr(x,"class","svelte-giybgk"),y.__value="eo",y.value=y.__value,attr(y,"lang","eo"),attr(y,"class","svelte-giybgk"),k.__value="eu",k.value=k.__value,attr(k,"lang","eu"),attr(k,"class","svelte-giybgk"),V.__value="fa",V.value=V.__value,attr(V,"lang","fa"),attr(V,"class","svelte-giybgk"),q.__value="fr",q.value=q.__value,attr(q,"lang","fr"),attr(q,"class","svelte-giybgk"),L.__value="gl",L.value=L.__value,attr(L,"lang","gl"),attr(L,"class","svelte-giybgk"),T.__value="ko",T.value=T.__value,attr(T,"lang","ko"),attr(T,"class","svelte-giybgk"),N.__value="hy",N.value=N.__value,attr(N,"lang","hy"),attr(N,"class","svelte-giybgk"),G.__value="hi",G.value=G.__value,attr(G,"lang","hi"),attr(G,"class","svelte-giybgk"),b.__value="hr",b.value=b.__value,attr(b,"lang","hr"),attr(b,"class","svelte-giybgk"),$.__value="id",$.value=$.__value,attr($,"lang","id"),attr($,"class","svelte-giybgk"),j.__value="it",j.value=j.__value,attr(j,"lang","it"),attr(j,"class","svelte-giybgk"),W.__value="he",W.value=W.__value,attr(W,"lang","he"),attr(W,"class","svelte-giybgk"),U.__value="ka",U.value=U.__value,attr(U,"lang","ka"),attr(U,"class","svelte-giybgk"),Z.__value="la",Z.value=Z.__value,attr(Z,"lang","la"),attr(Z,"class","svelte-giybgk"),I.__value="lv",I.value=I.__value,attr(I,"lang","lv"),attr(I,"class","svelte-giybgk"),M.__value="lt",M.value=M.__value,attr(M,"lang","lt"),attr(M,"class","svelte-giybgk"),P.__value="hu",P.value=P.__value,attr(P,"lang","hu"),attr(P,"class","svelte-giybgk"),F.__value="mk",F.value=F.__value,attr(F,"lang","mk"),attr(F,"class","svelte-giybgk"),H.__value="arz",H.value=H.__value,attr(H,"lang","arz"),attr(H,"class","svelte-giybgk"),O.__value="ms",O.value=O.__value,attr(O,"lang","ms"),attr(O,"class","svelte-giybgk"),K.__value="min",K.value=K.__value,attr(K,"lang","min"),attr(K,"class","svelte-giybgk"),te.__value="my",te.value=te.__value,attr(te,"lang","my"),attr(te,"class","svelte-giybgk"),ne.__value="nl",ne.value=ne.__value,attr(ne,"lang","nl"),attr(ne,"class","svelte-giybgk"),ae.__value="ja",ae.value=ae.__value,attr(ae,"lang","ja"),attr(ae,"class","svelte-giybgk"),Q.__value="no",Q.value=Q.__value,attr(Q,"lang","nb"),attr(Q,"class","svelte-giybgk"),re.__value="nn",re.value=re.__value,attr(re,"lang","nn"),attr(re,"class","svelte-giybgk"),se.__value="ce",se.value=se.__value,attr(se,"lang","ce"),attr(se,"class","svelte-giybgk"),ue.__value="uz",ue.value=ue.__value,attr(ue,"lang","uz"),attr(ue,"class","svelte-giybgk"),ce.__value="pt",ce.value=ce.__value,attr(ce,"lang","pt"),attr(ce,"class","svelte-giybgk"),X.__value="kk",X.value=X.__value,attr(X,"lang","kk"),attr(X,"class","svelte-giybgk"),ge.__value="ro",ge.value=ge.__value,attr(ge,"lang","ro"),attr(ge,"class","svelte-giybgk"),we.__value="ru",we.value=we.__value,attr(we,"lang","ru"),attr(we,"class","svelte-giybgk"),Pe.__value="simple",Pe.value=Pe.__value,attr(Pe,"lang","en"),attr(Pe,"class","svelte-giybgk"),be.__value="ceb",be.value=be.__value,attr(be,"lang","ceb"),attr(be,"class","svelte-giybgk"),xe.__value="sk",xe.value=xe.__value,attr(xe,"lang","sk"),attr(xe,"class","svelte-giybgk"),Ee.__value="sl",Ee.value=Ee.__value,attr(Ee,"lang","sl"),attr(Ee,"class","svelte-giybgk"),oe.__value="sr",oe.value=oe.__value,attr(oe,"lang","sr"),attr(oe,"class","svelte-giybgk"),le.__value="sh",le.value=le.__value,attr(le,"lang","sh"),attr(le,"class","svelte-giybgk"),me.__value="fi",me.value=me.__value,attr(me,"lang","fi"),attr(me,"class","svelte-giybgk"),ve.__value="sv",ve.value=ve.__value,attr(ve,"lang","sv"),attr(ve,"class","svelte-giybgk"),ye.__value="ta",ye.value=ye.__value,attr(ye,"lang","ta"),attr(ye,"class","svelte-giybgk"),ke.__value="tt",ke.value=ke.__value,attr(ke,"lang","tt"),attr(ke,"class","svelte-giybgk"),_e.__value="th",_e.value=_e.__value,attr(_e,"lang","th"),attr(_e,"class","svelte-giybgk"),fe.__value="tg",fe.value=fe.__value,attr(fe,"lang","tg"),attr(fe,"class","svelte-giybgk"),de.__value="azb",de.value=de.__value,attr(de,"lang","azb"),attr(de,"class","svelte-giybgk"),pe.__value="tr",pe.value=pe.__value,attr(pe,"lang","tr"),attr(pe,"class","svelte-giybgk"),Ce.__value="uk",Ce.value=Ce.__value,attr(Ce,"lang","uk"),attr(Ce,"class","svelte-giybgk"),Ae.__value="ur",Ae.value=Ae.__value,attr(Ae,"lang","ur"),attr(Ae,"class","svelte-giybgk"),he.__value="vi",he.value=he.__value,attr(he,"lang","vi"),attr(he,"class","svelte-giybgk"),Ie.__value="vo",Ie.value=Ie.__value,attr(Ie,"lang","vo"),attr(Ie,"class","svelte-giybgk"),Ne.__value="war",Ne.value=Ne.__value,attr(Ne,"lang","war"),attr(Ne,"class","svelte-giybgk"),Te.__value="zh-yue",Te.value=Te.__value,attr(Te,"lang","yue"),attr(Te,"class","svelte-giybgk"),Le.__value="zh",Le.value=Le.__value,attr(Le,"lang","zh"),attr(Le,"class","svelte-giybgk"),attr(r,"id","searchLanguage"),attr(r,"name","language"),attr(r,"class","select--real svelte-giybgk"),e[0]===void 0&&add_render_callback(()=>e[1].call(r)),attr(qe,"for","searchLanguage"),attr(qe,"class","svelte-giybgk"),attr(De,"class","select--fake svelte-giybgk"),attr(t,"class","select-wrapper svelte-giybgk")},m(Se,$e){insert(Se,t,$e),append(t,r),append(r,n),append(r,a),append(r,o),append(r,i),append(r,u),append(r,f),append(r,c),append(r,l),append(r,s),append(r,d),append(r,h),append(r,v),append(r,g),append(r,m),append(r,E),append(r,S),append(r,_),append(r,x),append(r,y),append(r,k),append(r,V),append(r,q),append(r,L),append(r,T),append(r,N),append(r,G),append(r,b),append(r,$),append(r,j),append(r,W),append(r,U),append(r,Z),append(r,I),append(r,M),append(r,P),append(r,F),append(r,H),append(r,O),append(r,K),append(r,te),append(r,ne),append(r,ae),append(r,Q),append(r,re),append(r,se),append(r,ue),append(r,ce),append(r,X),append(r,ge),append(r,we),append(r,Pe),append(r,be),append(r,xe),append(r,Ee),append(r,oe),append(r,le),append(r,me),append(r,ve),append(r,ye),append(r,ke),append(r,_e),append(r,fe),append(r,de),append(r,pe),append(r,Ce),append(r,Ae),append(r,he),append(r,Ie),append(r,Ne),append(r,Te),append(r,Le),select_option(r,e[0]),append(t,Ze),append(t,De),append(De,qe),append(qe,ze),append(De,Ue),mount_component(Re,De,null),Be=!0,Oe||(We=listen(r,"change",e[1]),Oe=!0)},p(Se,[$e]){$e&1&&select_option(r,Se[0]),(!Be||$e&1)&&set_data(ze,Se[0])},i(Se){Be||(transition_in(Re.$$.fragment,Se),Be=!0)},o(Se){transition_out(Re.$$.fragment,Se),Be=!1},d(Se){Se&&detach(t),destroy_component(Re),Oe=!1,We()}}}function instance$3(e,t,r){let n;const a=qs.get("lang");if(a)n=a;else{const i=(navigator.language||navigator.userLanguage).split("-")[0];console.log("user lang: "+i),n=i}function o(){n=select_value(this),r(0,n)}return e.$$.update=()=>{e.$$.dirty&1&&(console.log("[] selectedLang change:",n),appState.lang=n,apiClient.setLang(n))},[n,o]}class LanguageSelect extends SvelteComponent{constructor(t){super(),init(this,t,instance$3,create_fragment$3,safe_not_equal,{})}}var WikiSearch_svelte_svelte_type_style_lang="";function create_fragment$2(e){let t,r,n,a,o,i,u,f,c,l=(e[3]?e[4]:e[0]?"This graph was made from Wikipedia.":"Explore human knowledge..")+"",s,d,h,v;return o=new LanguageSelect({}),u=new Suggestions({props:{suggestions:e[1],selected:e[2]}}),u.$on("select",e[8]),{c(){t=element("div"),r=element("div"),n=element("input"),a=space(),create_component(o.$$.fragment),i=space(),create_component(u.$$.fragment),f=space(),c=element("div"),s=text(l),attr(n,"type","text"),attr(n,"name","Wiki Search input"),attr(n,"autocomplete","off"),attr(n,"placeholder","start wiki search..."),n.autofocus=!0,attr(n,"class","svelte-1gaujt2"),attr(r,"class","input-wrapper svelte-1gaujt2"),attr(c,"class","progress-info muted svelte-1gaujt2"),attr(t,"class","layout-container input-box svelte-1gaujt2")},m(g,m){insert(g,t,m),append(t,r),append(r,n),set_input_value(n,e[0]),append(r,a),mount_component(o,r,null),append(t,i),mount_component(u,t,null),append(t,f),append(t,c),append(c,s),d=!0,n.focus(),h||(v=[listen(n,"input",e[10]),listen(n,"click",e[7]),listen(n,"keyup",e[5]),listen(n,"keydown",e[6]),listen(n,"blur",e[11])],h=!0)},p(g,[m]){m&1&&n.value!==g[0]&&set_input_value(n,g[0]);const E={};m&2&&(E.suggestions=g[1]),m&4&&(E.selected=g[2]),u.$set(E),(!d||m&25)&&l!==(l=(g[3]?g[4]:g[0]?"This graph was made from Wikipedia.":"Explore human knowledge..")+"")&&set_data(s,l)},i(g){d||(transition_in(o.$$.fragment,g),transition_in(u.$$.fragment,g),d=!0)},o(g){transition_out(o.$$.fragment,g),transition_out(u.$$.fragment,g),d=!1},d(g){g&&detach(t),destroy_component(o),destroy_component(u),h=!1,run_all(v)}}}function instance$2(e,t,r){let n,a,o=appState.query,i=[],u=0;const f=createEventDispatcher();async function c(E){console.log("[search] query:",E),f("search",E)}async function l(E){var _;console.log("keyup:",E);const S=o.trim();if(!S){console.log("[onKeyup] empty query given!"),r(0,o=""),v();return}if(E.key==="Escape"){v();return}if(E.key==="Enter"){r(0,o=((_=i[u])==null?void 0:_.title)||S),c(o),v();return}d()}function s(E){if(E.key==="ArrowUp"){E.preventDefault(),r(2,u=u?u-1:i.length-1);return}if(E.key==="ArrowDown"){E.preventDefault(),r(2,u=u===i.length-1?0:u+1);return}}async function d(){const E=o.trim();!E||r(1,i=await apiClient.suggestCustom(E))}function h(E){var S;r(0,o=(S=i[E.detail])==null?void 0:S.title),c(o),v()}function v(){r(1,i=[]),r(2,u=0)}watchState((E,S,_)=>{switch(S){case"message":r(4,a=_);return;case"working":r(3,n=_);return;case"query":r(0,o=_);return;default:return}});function g(){o=this.value,r(0,o)}const m=()=>setTimeout(v,100);return r(3,n=appState.progress.working),r(4,a=appState.progress.message),[o,i,u,n,a,l,s,d,h,v,g,m]}class WikiSearch extends SvelteComponent{constructor(t){super(),init(this,t,instance$2,create_fragment$2,safe_not_equal,{})}}var About_svelte_svelte_type_style_lang="";function create_fragment$1(e){let t,r,n,a,o,i,u,f,c,l,s,d,h,v,g=e[2][e[1]].inspiredBy+"",m,E,S,_,x,y=e[2][e[1]].checkOut+"",k,V,q,L,T=e[2][e[1]].enjoy+"",N,G,b,$,j,W,U,Z,I,M,P,F,H=e[2][e[1]].node.role+"",O,K,te,ne,ae,Q,re=e[2][e[1]].edge.role+"",se,ue,ce,X,ge,we,Pe=e[2][e[1]].nodeClick.role+"",be,xe,Ee,oe,le,me,ve=e[2][e[1]].nodeHover.role+"",ye,ke,_e,fe;return{c(){t=element("article"),r=element("div"),n=element("section"),a=element("h1"),a.textContent="Wiki Graph",o=space(),i=element("button"),i.textContent="Esc",u=space(),f=element("p"),f.textContent=`${e[2][e[1]].descShort}`,c=space(),l=element("p"),l.textContent=`${e[2][e[1]].desc}`,s=space(),d=element("p"),d.textContent=`${e[2][e[1]].descTechnical}`,h=space(),v=element("div"),m=text(g),E=space(),S=element("span"),_=text("anvaka's "),x=element("a"),x.textContent="vs-autocomplete",k=text(y),V=text("."),q=space(),L=element("p"),N=text(T),G=text(","),b=element("br"),$=space(),j=element("code"),j.innerHTML='<a href="https://github.com/blinpete" target="_blank" rel="noopener noreferrer">blinpete</a>',W=space(),U=element("section"),Z=element("div"),I=element("ul"),M=element("li"),P=element("strong"),P.textContent=`${e[2][e[1]].node.name}`,F=space(),O=text(H),K=text("."),te=space(),ne=element("li"),ae=element("strong"),ae.textContent=`${e[2][e[1]].edge.name}`,Q=space(),se=text(re),ue=text("."),ce=space(),X=element("li"),ge=element("strong"),ge.textContent=`${e[2][e[1]].nodeClick.name}`,we=space(),be=text(Pe),xe=text("."),Ee=space(),oe=element("li"),le=element("strong"),le.textContent=`${e[2][e[1]].nodeHover.name}`,me=space(),ye=text(ve),ke=text("."),attr(a,"class","title svelte-9rfcj8"),attr(i,"class","btn-close svelte-9rfcj8"),attr(f,"class","tiny-note svelte-9rfcj8"),attr(x,"href","https://anvaka.github.io/vs/?query="),attr(x,"target","_blank"),attr(x,"rel","noopener noreferrer"),attr(v,"class","inspiration svelte-9rfcj8"),attr(L,"class","p-last footnote svelte-9rfcj8"),attr(n,"class","main svelte-9rfcj8"),attr(I,"class","svelte-9rfcj8"),attr(Z,"class","features"),attr(U,"class","side svelte-9rfcj8"),attr(r,"class","about-container svelte-9rfcj8"),attr(t,"class","about svelte-9rfcj8")},m(de,pe){insert(de,t,pe),append(t,r),append(r,n),append(n,a),append(n,o),append(n,i),append(n,u),append(n,f),append(n,c),append(n,l),append(n,s),append(n,d),append(n,h),append(n,v),append(v,m),append(v,E),append(v,S),append(S,_),append(S,x),append(S,k),append(S,V),append(n,q),append(n,L),append(L,N),append(L,G),append(L,b),append(L,$),append(L,j),append(r,W),append(r,U),append(U,Z),append(Z,I),append(I,M),append(M,P),append(M,F),append(M,O),append(M,K),append(I,te),append(I,ne),append(ne,ae),append(ne,Q),append(ne,se),append(ne,ue),append(I,ce),append(I,X),append(X,ge),append(X,we),append(X,be),append(X,xe),append(I,Ee),append(I,oe),append(oe,le),append(oe,me),append(oe,ye),append(oe,ke),_e||(fe=[listen(window,"keydown",e[3]),listen(i,"click",e[4]),listen(r,"click",click_handler_1),listen(t,"click",e[5])],_e=!0)},p:noop$4,i:noop$4,o:noop$4,d(de){de&&detach(t),_e=!1,run_all(fe)}}}const click_handler_1=e=>e.stopPropagation();function instance$1(e){const t=createEventDispatcher();let r=appState.lang==="ru"?"ru":"en";const n={en:{descShort:"a graph client for Wikipedia",desc:"Wiki Graph gets your query and takes two steps further to show you the bigger picture of what you're searching for. This way you can see related topics as well as connections between them.",descTechnical:"It starts with a wiki article you give, collects top 20 related articles, then for each one collects their top 20 and finally draws a graph of everything that's found.",inspiredBy:"This was heavily inspired by",checkOut:" so check out his project",enjoy:"Enjoy diving into knowledge",node:{name:"Node",role:"represents a wiki article"},edge:{name:"Edge",role:"represents a relation between two articles"},nodeClick:{name:"Node click",role:"opens the article in a new tab"},nodeHover:{name:"Node hover",role:"shows the article preview in a small popup"}},ru:{descShort:"\u0433\u0440\u0430\u0444 \u043A\u043B\u0438\u0435\u043D\u0442 \u0434\u043B\u044F \u0412\u0438\u043A\u0438\u043F\u0435\u0434\u0438\u0438",desc:"Wiki Graph \u043F\u0440\u0438\u043D\u0438\u043C\u0430\u0435\u0442 \u0437\u0430\u043F\u0440\u043E\u0441 \u0438 \u043F\u0440\u043E\u0445\u043E\u0434\u0438\u0442 \u043D\u0430 \u0434\u0432\u0430 \u0448\u0430\u0433\u0430 \u0432\u043F\u0435\u0440\u0435\u0434, \u0447\u0442\u043E\u0431\u044B \u043F\u043E\u043A\u0430\u0437\u0430\u0442\u044C \u0431\u043E\u043B\u0435\u0435 \u043F\u043E\u043B\u043D\u0443\u044E \u043A\u0430\u0440\u0442\u0438\u043D\u0443 \u043F\u043E\u0438\u0441\u043A\u0430. \u0422\u0430\u043A \u043C\u043E\u0436\u043D\u043E \u0443\u0432\u0438\u0434\u0435\u0442\u044C \u0441\u043C\u0435\u0436\u043D\u044B\u0435 \u0442\u0435\u043C\u044B \u0438 \u0441\u0432\u044F\u0437\u0438 \u043C\u0435\u0436\u0434\u0443 \u043D\u0438\u043C\u0438.",descTechnical:"\u041D\u0430\u0447\u0438\u043D\u0430\u044F \u0441 \u0432\u044B\u0431\u0440\u0430\u043D\u043D\u043E\u0439 \u0432\u0438\u043A\u0438 \u0441\u0442\u0430\u0442\u044C\u0438, \u0430\u043B\u0433\u043E\u0440\u0438\u0442\u043C \u0441\u043E\u0431\u0438\u0440\u0430\u0435\u0442 \u0442\u043E\u043F 20 \u0441\u043C\u0435\u0436\u043D\u044B\u0445 \u0441\u0442\u0430\u0442\u0435\u0439, \u043F\u043E\u0442\u043E\u043C \u0434\u043B\u044F \u043A\u0430\u0436\u0434\u043E\u0439 \u0438\u0437 \u043D\u0438\u0445 \u0441\u043E\u0431\u0438\u0440\u0430\u0435\u0442 \u0435\u0435 \u0442\u043E\u043F 20 \u0438 \u043D\u0430\u043A\u043E\u043D\u0435\u0446 \u0440\u0438\u0441\u0443\u0435\u0442 \u0433\u0440\u0430\u0444 \u0438\u0437 \u0432\u0441\u0435\u0433\u043E, \u0447\u0442\u043E \u043D\u0430\u0439\u0434\u0435\u043D\u043E.",inspiredBy:"\u0420\u0430\u0431\u043E\u0442\u0430 \u0432\u0434\u043E\u0445\u043D\u043E\u0432\u043B\u0435\u043D\u0430 \u043F\u0440\u043E\u0435\u043A\u0442\u043E\u043C",checkOut:" \u0438 \u043E\u0441\u043D\u043E\u0432\u0430\u043D\u0430 \u043D\u0430 \u0435\u0433\u043E \u0434\u0432\u0438\u0436\u043A\u0435",enjoy:"\u041D\u0443 \u0432\u0441\u0435, \u0440\u0430\u0437\u0432\u043B\u0435\u043A\u0430\u0439\u0442\u0435\u0441\u044C \u0438 \u0431\u043E\u0442\u0430\u0439\u0442\u0435",node:{name:"\u0423\u0437\u0435\u043B",role:"\u044D\u0442\u043E \u0432\u0438\u043A\u0438-\u0441\u0442\u0430\u0442\u044C\u044F"},edge:{name:"\u0420\u0435\u0431\u0440\u043E",role:"\u043F\u043E\u043A\u0430\u0437\u044B\u0432\u0430\u0435\u0442 \u0441\u0432\u044F\u0437\u044C \u043C\u0435\u0436\u0434\u0443 \u0434\u0432\u0443\u043C\u044F \u0441\u0442\u0430\u0442\u044C\u044F\u043C\u0438"},nodeClick:{name:"\u041A\u043B\u0438\u043A \u043F\u043E \u0443\u0437\u0435\u043B\u0443",role:"\u043E\u0442\u043A\u0440\u044B\u0432\u0430\u0435\u0442 \u0441\u0442\u0430\u0442\u044C\u044E \u0432 \u043D\u043E\u0432\u043E\u0439 \u0432\u043A\u043B\u0430\u0434\u043A\u0435"},nodeHover:{name:"\u041D\u0430\u0432\u0435\u0434\u0435\u043D\u0438\u0435 \u043D\u0430 \u0443\u0437\u0435\u043B",role:"\u043F\u043E\u043A\u0430\u0437\u044B\u0432\u0430\u0435\u0442 \u043F\u0440\u0435\u0432\u044C\u044E\u0448\u043A\u0443 \u0441\u0442\u0430\u0442\u044C\u0438"}}};function a(u){u.key==="Escape"&&t("hide")}return[t,r,n,a,()=>t("hide"),()=>t("hide")]}class About extends SvelteComponent{constructor(t){super(),init(this,t,instance$1,create_fragment$1,safe_not_equal,{})}}var App_svelte_svelte_type_style_lang="";function create_if_block(e){let t,r;return t=new About({}),t.$on("hide",e[9]),{c(){create_component(t.$$.fragment)},m(n,a){mount_component(t,n,a),r=!0},p:noop$4,i(n){r||(transition_in(t.$$.fragment,n),r=!0)},o(n){transition_out(t.$$.fragment,n),r=!1},d(n){destroy_component(t,n)}}}function create_fragment(e){let t,r,n,a,o,i,u,f,c,l,s,d,h;t=new WikiSearch({}),t.$on("search",e[6]);let v=e[0]&&create_if_block(e);return{c(){create_component(t.$$.fragment),r=space(),n=element("div"),a=element("a"),a.textContent="about",o=space(),i=element("a"),i.textContent="code",u=space(),f=element("div"),c=space(),v&&v.c(),l=empty(),attr(a,"href","#"),attr(a,"class","svelte-v35h67"),attr(i,"href","https://github.com/blinpete/wiki-graph"),attr(i,"target","_blank"),attr(i,"rel","noopener noreferrer"),attr(i,"class","svelte-v35h67"),attr(n,"class","layout-container about-links muted svelte-v35h67"),attr(f,"id","tooltip"),f.hidden=e[1],attr(f,"class","svelte-v35h67")},m(g,m){mount_component(t,g,m),insert(g,r,m),insert(g,n,m),append(n,a),append(n,o),append(n,i),insert(g,u,m),insert(g,f,m),f.innerHTML=e[2],e[8](f),insert(g,c,m),v&&v.m(g,m),insert(g,l,m),s=!0,d||(h=[listen(a,"click",e[7]),listen(f,"mouseenter",e[4]),listen(f,"mouseleave",e[5])],d=!0)},p(g,[m]){(!s||m&4)&&(f.innerHTML=g[2]),(!s||m&2)&&(f.hidden=g[1]),g[0]?v?(v.p(g,m),m&1&&transition_in(v,1)):(v=create_if_block(g),v.c(),transition_in(v,1),v.m(l.parentNode,l)):v&&(group_outros(),transition_out(v,1,1,()=>{v=null}),check_outros())},i(g){s||(transition_in(t.$$.fragment,g),transition_in(v),s=!0)},o(g){transition_out(t.$$.fragment,g),transition_out(v),s=!1},d(g){destroy_component(t,g),g&&detach(r),g&&detach(n),g&&detach(u),g&&detach(f),e[8](null),g&&detach(c),v&&v.d(g),g&&detach(l),d=!1,run_all(h)}}}const DEFAULT_LANG="en",ttWidth=400;function onNodeClick(e){window.open(e.node.data.page_url)}function instance(e,t,r){let n=!1;apiClient.setLang(appState.lang||DEFAULT_LANG);const a=createRenderer(appState.progress);appState.query&&E(appState.query).then(y=>{appState.graph&&a.render(appState.graph)});let o=!0,i="",u,f,c;function l(){return setTimeout(()=>{r(1,o=!0)},100)}function s(){return setTimeout(()=>{r(1,o=!1),clearTimeout(c),c=null},200)}function d(){clearTimeout(f)}function h(){f=l()}function v(y){if(clearTimeout(f),!y.node){f=l(),clearTimeout(c),c=null;return}if(c)return;const k={x:visualViewport.width/2,y:visualViewport.height/2},q={x:k.x-y.x,y:k.y-y.y}.y<0,{thumbnail:L,extract_html:T,page_url:N}=y.node.data;r(2,i=L?`<img src="${L.source}" />`:"");const G=`Can't find a preview. See <a href="${N}">the original article</a>`;r(2,i+=`<div class="text">${T||G}</div>`),c=s();let b;requestAnimationFrame(()=>{b=y.x-ttWidth/3,b=Math.max(10,b),b=Math.min(visualViewport.width-ttWidth-10,b),r(3,u.style.left=b+"px",u),q?(r(3,u.style.top="unset",u),r(3,u.style.bottom=visualViewport.height-y.y+20+"px",u)):(r(3,u.style.top=y.y+20+"px",u),r(3,u.style.bottom="unset",u))})}bus.on("show-tooltip-node",v,{}),bus.on("show-details-node",onNodeClick,{});function g(y){appState.query=y.node.id,m({detail:y.node.id})}bus.on("node-click-right",g,{});async function m(y){const k=y.detail;await E(k),a.render(appState.graph)}async function E(y){const k=await apiClient.getSummary(y),V=apiClient.getItem(k);performSearch(V)}const S=()=>r(0,n=!0);function _(y){binding_callbacks[y?"unshift":"push"](()=>{u=y,r(3,u)})}return[n,o,i,u,d,h,m,S,_,()=>r(0,n=!1)]}class App extends SvelteComponent{constructor(t){super(),init(this,t,instance,create_fragment,safe_not_equal,{})}}new App({target:document.getElementById("app")});
